---
title: "Análisis Discriminante"
author: "Pamela E. Pairo"
output:
  html_document:
    toc: yes
    code_folding: show
    toc_float: yes
    df_print: paged
    theme: united
    code_download: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
library(tidyverse)
library(factoextra)
library(mvShapiroTest)
library(biotools)
library(downloadthis)
library(MASS)
```

```{r, echo = FALSE}

download_link(
  link = "https://github.com/PamelaPairo/maestria_DM/raw/main/AID/AD/analisis_discriminante.Rmd",
  button_label = "Download .Rmd",
  button_type = "danger",
  has_icon = TRUE,
  icon = "fa fa-save",
  self_contained = FALSE
)
```


Es una técnica de **clasificación** en donde hay más de una variable respuesta (cuantitativa) medida en grupos predeterminados.

El objetivo es:

- Separar los grupos, identificando las variables que permiten esa separación

- Clasificar a nuevos individuos

# Base de datos

Vamos a trabajar con la base de datos de `Iris`


```{r}
data(iris)
glimpse(iris)
```

```{r}
setosa<- subset(iris[,1:4], iris$Species == "setosa")
versicolor<- subset(iris[,1:4], iris$Species == "versicolor")
virginica <- subset(iris[,1:4], iris$Species=="virginica")
```

# Análisis Discriminante Lineal (LDA)

Este tipo de análisis es válido solo si se satisfacen los siguientes supuestos:

1- Distribución de normalidad multivariada

2- Independencia de las observaciones

3- Homocedasticidad.

## Verefiquemos supuestos

1- Normalidad multivariada

¿Cuál es la hipótesis estadística?

```{r}
mvShapiro.Test(as.matrix(setosa))
mvShapiro.Test(as.matrix(versicolor))  
mvShapiro.Test(as.matrix(virginica))
```
2- Independencia de las observaciones

Viene dada por el diseño

3- Homocedasticidad

Analizamos igualdad de matrices de varianzas y covarianzas:

```{r}
boxM(iris[,-5],iris[,5])
```

