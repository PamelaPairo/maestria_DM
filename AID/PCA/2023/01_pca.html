<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pamela E. Pairo">

<title>An√°lisis de Componentes Principales</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="01_pca_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_pca_files/libs/quarto-html/quarto.js"></script>
<script src="01_pca_files/libs/quarto-html/popper.min.js"></script>
<script src="01_pca_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01_pca_files/libs/quarto-html/anchor.min.js"></script>
<link href="01_pca_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_pca_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01_pca_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01_pca_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01_pca_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="01_pca_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="01_pca_files/libs/rglWebGL-binding-0.109.2/rglWebGL.js"></script>
<link href="01_pca_files/libs/rglwidgetClass-0.109.2/rgl.css" rel="stylesheet">
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/rglClass.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/utils.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/buffer.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/subscenes.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/shaders.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/textures.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/projection.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/mouse.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/init.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/pieces.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/draw.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/controls.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/selection.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/rglTimer.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/pretty.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/axes.src.js"></script>
<script src="01_pca_files/libs/rglwidgetClass-0.109.2/animation.src.js"></script>
<script type="text/plain" id="rgl-vertex-shader">
#line 2 1
// File 1 is the vertex shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif

attribute vec3 aPos;
attribute vec4 aCol;
uniform mat4 mvMatrix;
uniform mat4 prMatrix;
varying vec4 vCol;
varying vec4 vPosition;

#ifdef NEEDS_VNORMAL
attribute vec3 aNorm;
uniform mat4 normMatrix;
varying vec4 vNormal;
#endif

#if defined(HAS_TEXTURE) || defined (IS_TEXT)
attribute vec2 aTexcoord;
varying vec2 vTexcoord;
#endif

#ifdef FIXED_SIZE
uniform vec3 textScale;
#endif

#ifdef FIXED_QUADS
attribute vec3 aOfs;
#endif

#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
varying float normz;
uniform mat4 invPrMatrix;
#else
attribute vec3 aPos1;
attribute vec3 aPos2;
varying float normz;
#endif
#endif // IS_TWOSIDED

#ifdef FAT_LINES
attribute vec3 aNext;
attribute vec2 aPoint;
varying vec2 vPoint;
varying float vLength;
uniform float uAspect;
uniform float uLwd;
#endif


void main(void) {
  
#ifndef IS_BRUSH
#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)
  vPosition = mvMatrix * vec4(aPos, 1.);
#endif
  
#ifndef FIXED_QUADS
  gl_Position = prMatrix * vPosition;
#endif
#endif // !IS_BRUSH
  
#ifdef IS_POINTS
  gl_PointSize = POINTSIZE;
#endif
  
  vCol = aCol;
  
#ifdef NEEDS_VNORMAL
  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));
#endif
  
#ifdef IS_TWOSIDED
#ifdef HAS_NORMALS
  /* normz should be calculated *after* projection */
  normz = (invPrMatrix*vNormal).z;
#else
  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));
  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;
  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));
  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;
  normz = pos1.x*pos2.y - pos1.y*pos2.x;
#endif
#endif // IS_TWOSIDED
  
#ifdef NEEDS_VNORMAL
  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);
#endif
  
#if defined(HAS_TEXTURE) || defined(IS_TEXT)
  vTexcoord = aTexcoord;
#endif
  
#if defined(FIXED_SIZE) && !defined(ROTATING)
  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w;
  gl_Position = pos + vec4(aOfs*textScale, 0.);
#endif
  
#if defined(IS_SPRITES) && !defined(FIXED_SIZE)
  vec4 pos = mvMatrix * vec4(aPos, 1.);
  pos = pos/pos.w + vec4(aOfs,  0.);
  gl_Position = prMatrix*pos;
#endif
  
#ifdef FAT_LINES
  /* This code was inspired by Matt Deslauriers' code in 
   https://mattdesl.svbtle.com/drawing-lines-is-hard */
  vec2 aspectVec = vec2(uAspect, 1.0);
  mat4 projViewModel = prMatrix * mvMatrix;
  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);
  currentProjected = currentProjected/currentProjected.w;
  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);
  vec2 currentScreen = currentProjected.xy * aspectVec;
  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;
  float len = uLwd;
  vec2 dir = vec2(1.0, 0.0);
  vPoint = aPoint;
  vLength = length(nextScreen - currentScreen)/2.0;
  vLength = vLength/(vLength + len);
  if (vLength > 0.0) {
    dir = normalize(nextScreen - currentScreen);
  }
  vec2 normal = vec2(-dir.y, dir.x);
  dir.x /= uAspect;
  normal.x /= uAspect;
  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);
  gl_Position = currentProjected + offset;
#endif
  
#ifdef IS_BRUSH
  gl_Position = vec4(aPos, 1.);
#endif
}
</script>
<script type="text/plain" id="rgl-fragment-shader">
#line 2 2
// File 2 is the fragment shader
#ifdef GL_ES
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
#endif
varying vec4 vCol; // carries alpha
varying vec4 vPosition;
#if defined(HAS_TEXTURE) || defined (IS_TEXT)
varying vec2 vTexcoord;
uniform sampler2D uSampler;
#endif

#ifdef HAS_FOG
uniform int uFogMode;
uniform vec3 uFogColor;
uniform vec4 uFogParms;
#endif

#if defined(IS_LIT) && !defined(FIXED_QUADS)
varying vec4 vNormal;
#endif

#if NCLIPPLANES > 0
uniform vec4 vClipplane[NCLIPPLANES];
#endif

#if NLIGHTS > 0
uniform mat4 mvMatrix;
#endif

#ifdef IS_LIT
uniform vec3 emission;
uniform float shininess;
#if NLIGHTS > 0
uniform vec3 ambient[NLIGHTS];
uniform vec3 specular[NLIGHTS]; // light*material
uniform vec3 diffuse[NLIGHTS];
uniform vec3 lightDir[NLIGHTS];
uniform bool viewpoint[NLIGHTS];
uniform bool finite[NLIGHTS];
#endif
#endif // IS_LIT

#ifdef IS_TWOSIDED
uniform bool front;
varying float normz;
#endif

#ifdef FAT_LINES
varying vec2 vPoint;
varying float vLength;
#endif

void main(void) {
  vec4 fragColor;
#ifdef FAT_LINES
  vec2 point = vPoint;
  bool neg = point.y < 0.0;
  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :
                 -(point.y - vLength)/(1.0 - vLength);
#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)
  if (neg && length(point) <= 1.0) discard;
#endif
  point.y = min(point.y, 0.0);
  if (length(point) > 1.0) discard;
#endif // FAT_LINES
  
#ifdef ROUND_POINTS
  vec2 coord = gl_PointCoord - vec2(0.5);
  if (length(coord) > 0.5) discard;
#endif
  
#if NCLIPPLANES > 0
  for (int i = 0; i < NCLIPPLANES; i++)
    if (dot(vPosition, vClipplane[i]) < 0.0) discard;
#endif
    
#ifdef FIXED_QUADS
    vec3 n = vec3(0., 0., 1.);
#elif defined(IS_LIT)
    vec3 n = normalize(vNormal.xyz);
#endif
    
#ifdef IS_TWOSIDED
    if ((normz <= 0.) != front) discard;
#endif
    
#ifdef IS_LIT
    vec3 eye = normalize(-vPosition.xyz/vPosition.w);
    vec3 lightdir;
    vec4 colDiff;
    vec3 halfVec;
    vec4 lighteffect = vec4(emission, 0.);
    vec3 col;
    float nDotL;
#ifdef FIXED_QUADS
    n = -faceforward(n, n, eye);
#endif
    
#if NLIGHTS > 0
    for (int i=0;i<NLIGHTS;i++) {
      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);
      lightdir = lightDir[i];
      if (!viewpoint[i])
        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;
      if (!finite[i]) {
        halfVec = normalize(lightdir + eye);
      } else {
        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);
        halfVec = normalize(lightdir + eye);
      }
      col = ambient[i];
      nDotL = dot(n, lightdir);
      col = col + max(nDotL, 0.) * colDiff.rgb;
      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];
      lighteffect = lighteffect + vec4(col, colDiff.a);
    }
#endif
    
#else // not IS_LIT
    vec4 colDiff = vCol;
    vec4 lighteffect = colDiff;
#endif
    
#ifdef IS_TEXT
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef HAS_TEXTURE
#ifdef TEXTURE_rgb
    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);
#endif
    
#ifdef TEXTURE_rgba
    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);
#endif
    
#ifdef TEXTURE_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;
    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);
#endif
    
#ifdef TEXTURE_luminance
    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);
#endif
    
#ifdef TEXTURE_luminance_alpha
    vec4 textureColor = texture2D(uSampler, vTexcoord);
    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;
    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);
#endif
    
    fragColor = textureColor;

#elif defined(IS_TEXT)
    if (textureColor.a < 0.1)
      discard;
    else
      fragColor = textureColor;
#else
    fragColor = lighteffect;
#endif // HAS_TEXTURE
    
#ifdef HAS_FOG
    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))
    // In Exp and Exp2: use density = density/far
    // fogF will be the proportion of fog
    // Initialize it to the linear value
    float fogF;
    if (uFogMode > 0) {
      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);
      if (uFogMode > 1)
        fogF = mix(uFogParms.w, 1.0, fogF);
      fogF = fogF*uFogParms.z;
      if (uFogMode == 2)
        fogF = 1.0 - exp(-fogF);
      // Docs are wrong: use (density*c)^2, not density*c^2
      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58
      else if (uFogMode == 3)
        fogF = 1.0 - exp(-fogF*fogF);
      fogF = clamp(fogF, 0.0, 1.0);
      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);
    } else gl_FragColor = fragColor;
#else
    gl_FragColor = fragColor;
#endif // HAS_FOG
    
}
</script>
<script src="01_pca_files/libs/CanvasMatrix4-0.109.2/CanvasMatrix.src.js"></script>
<script src="01_pca_files/libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="01_pca_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="01_pca_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="01_pca_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="01_pca_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="01_pca_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="01_pca_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#matriz-de-varianzas-y-covarianzas" id="toc-matriz-de-varianzas-y-covarianzas" class="nav-link active" data-scroll-target="#matriz-de-varianzas-y-covarianzas">Matriz de Varianzas y covarianzas</a></li>
  <li><a href="#matriz-de-correlaciones" id="toc-matriz-de-correlaciones" class="nav-link" data-scroll-target="#matriz-de-correlaciones">Matriz de Correlaciones</a>
  <ul class="collapse">
  <li><a href="#que-matriz-usar-para-extraer-a-los-componentes" id="toc-que-matriz-usar-para-extraer-a-los-componentes" class="nav-link" data-scroll-target="#que-matriz-usar-para-extraer-a-los-componentes">¬øQue matriz usar para extraer a los componentes?</a></li>
  </ul></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a>
  <ul class="collapse">
  <li><a href="#loadings" id="toc-loadings" class="nav-link" data-scroll-target="#loadings"><em>Loadings</em></a></li>
  <li><a href="#autovalores" id="toc-autovalores" class="nav-link" data-scroll-target="#autovalores">Autovalores</a></li>
  <li><a href="#biplot" id="toc-biplot" class="nav-link" data-scroll-target="#biplot">Biplot</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">An√°lisis de Componentes Principales</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> C√≥digo</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el c√≥digo</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el c√≥digo</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el c√≥digo fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Pamela E. Pairo </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p><strong>Contexto</strong></p>
<p>Hay bastante heterogeneidad entre los individuos de una planta de baja capacidad dispersiva que crece en valles intermontanos.Los investigadores del asunto desean saber si pueden describir esa heterogeneidad con un n√∫mero menor de dimensiones que las 7 caracter√≠sticas vegetativas y reproductivas que midieron.</p>
<p>Partes de una flor</p>
<p><img src="https://i.pinimg.com/originals/e5/3b/78/e53b7858a464dfb20738473fff0c19f5.jpg" class="img-fluid"></p>
<p>Internodo</p>
<p><img src="https://images.vexels.com/media/users/3/202454/raw/a6f138847ef867363d9afb3d13b2e792-diseno-de-anatomia-de-plantas-de-flores.jpg" class="img-fluid"></p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Carga de la base de datos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span><span class="fu">read.delim2</span>(<span class="st">"plantas.txt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="st">'Poblacion'</span>, as.factor) <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.numeric))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 120
Columns: 8
$ Poblacion  &lt;fct&gt; I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I, I,~
$ Petalo     &lt;dbl&gt; 5.621498, 4.994617, 4.767505, 6.299446, 6.489375, 5.785868,~
$ Internodal &lt;dbl&gt; 29.48060, 28.36025, 27.25432, 25.92424, 25.21131, 25.52433,~
$ Sepalo     &lt;dbl&gt; 2.462107, 2.429321, 2.570497, 2.066051, 2.901583, 2.655643,~
$ Bractea    &lt;dbl&gt; 18.20341, 17.65205, 19.40838, 18.37915, 17.31305, 17.07216,~
$ Peciolo    &lt;dbl&gt; 11.27910, 11.04084, 10.49072, 11.80182, 10.12159, 10.55816,~
$ Hoja       &lt;dbl&gt; 1.128033, 1.197617, 1.003808, 1.614052, 1.813333, 1.955524,~
$ Fruto      &lt;dbl&gt; 7.876151, 7.025416, 7.817479, 7.672492, 7.758443, 7.880880,~</code></pre>
</div>
</div>
<p><strong>Objetivo del PCA</strong></p>
<p>Reducir el n√∫mero de variables generando <strong>nuevas variables que resuman la informaci√≥n original</strong>. Revelar patrones en los datos que pueden no ser detectados al analizar las variables por separado.</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Petalo, <span class="at">y=</span>Internodal)) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">colour=</span><span class="st">'#56B4E9'</span>, <span class="at">shape=</span><span class="dv">19</span>)<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Largo Petalo"</span>)<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Largo S√©palo"</span>)<span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Trabajamos unicamente con las variables num√©ricas.</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_numericas <span class="ot">&lt;-</span>df <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Todos contra todos</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gpairs_lower <span class="ot">&lt;-</span> <span class="cf">function</span>(g){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>plots <span class="ot">&lt;-</span> g<span class="sc">$</span>plots[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>g<span class="sc">$</span>nrow)]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>yAxisLabels <span class="ot">&lt;-</span> g<span class="sc">$</span>yAxisLabels[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>nrow <span class="ot">&lt;-</span> g<span class="sc">$</span>nrow <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>plots <span class="ot">&lt;-</span> g<span class="sc">$</span>plots[<span class="sc">-</span>(<span class="fu">seq</span>(g<span class="sc">$</span>ncol, <span class="fu">length</span>(g<span class="sc">$</span>plots), <span class="at">by =</span> g<span class="sc">$</span>ncol))]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>xAxisLabels <span class="ot">&lt;-</span> g<span class="sc">$</span>xAxisLabels[<span class="sc">-</span>g<span class="sc">$</span>ncol]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>ncol <span class="ot">&lt;-</span> g<span class="sc">$</span>ncol <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  g</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span><span class="fu">ggpairs</span>(df_numericas, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">color =</span> df<span class="sc">$</span>Poblacion, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>, <span class="at">combo =</span> <span class="st">"dot"</span>), </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper  =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"blank"</span>), <span class="at">legend =</span> <span class="dv">1</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">gpairs_lower</span>(g)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(df)  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">fill=</span> Poblacion)) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Representaci√≥n tridimensional de variables</strong></p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(df<span class="sc">$</span>Petalo, df<span class="sc">$</span>Sepalo, df<span class="sc">$</span>Internodal, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">phi =</span> <span class="dv">0</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"g"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="dv">2</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">colvar=</span><span class="cn">NULL</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">"Petalo"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">"Sepalo"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab=</span><span class="st">"Internodal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'royalblue1'</span>, <span class="st">'darkcyan'</span>, <span class="st">'oldlace'</span>, <span class="st">'red'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>color <span class="ot">&lt;-</span> mycolors[ <span class="fu">as.numeric</span>(df<span class="sc">$</span>Poblacion) ]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(df<span class="sc">$</span>Petalo, df<span class="sc">$</span>Sepalo, df<span class="sc">$</span>Internodal, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">'s'</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">radius =</span> .<span class="dv">1</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> df<span class="sc">$</span>color,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">"Petalo"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">"Sepalo"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab=</span><span class="st">"Internodal"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rglwidget</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display no-overflow-x">
<div id="rgl61034" style="width:100%;height:464px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl61034">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":""},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.100000001490116]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[["Petalo"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[["Sepalo"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[["Internodal"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[1,0.5,1],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,20.2156600952148],"modelMatrix":[[1.04424011707306,0,0,-6.53412008285522],[0,0.523666143417358,0.730143249034882,-22.3038101196289],[0,-1.43876087665558,0.265750408172607,-22.6419296264648],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370372772217,-72.8751220703125],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1.04424011707306,1.53109741210938,0.777002215385437],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.97348237037659,8.54111099243164,1.93557572364807,5.0507926940918,24.972526550293,31.111120223999],"windowRect":[60,83,316,339],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":120,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":120,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":120,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":19,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":1440,"byteOffset":0},{"buffer":0,"byteLength":480,"byteOffset":1440},{"buffer":0,"byteLength":1440,"byteOffset":1920},{"buffer":0,"byteLength":12,"byteOffset":3360},{"buffer":0,"byteLength":4,"byteOffset":3372},{"buffer":0,"byteLength":12,"byteOffset":3376},{"buffer":0,"byteLength":12,"byteOffset":3388},{"buffer":0,"byteLength":4,"byteOffset":3400},{"buffer":0,"byteLength":12,"byteOffset":3404},{"buffer":0,"byteLength":12,"byteOffset":3416},{"buffer":0,"byteLength":4,"byteOffset":3428},{"buffer":0,"byteLength":12,"byteOffset":3432},{"buffer":0,"byteLength":16,"byteOffset":3444},{"buffer":0,"byteLength":3,"byteOffset":3460},{"buffer":0,"byteLength":4,"byteOffset":3463},{"buffer":0,"byteLength":3,"byteOffset":3467},{"buffer":0,"byteLength":228,"byteOffset":3472},{"buffer":0,"byteLength":4,"byteOffset":3700}],"buffers":[{"byteLength":3704,"bytes":"UeOzQCeTHUBD2OtB59OfQP55G0DJ4eJBZo+YQAeDJEDYCNpBD5XJQC86BEDXZM9B9qjPQIiz\nOUDCsMlB1SW5QA32KUDVMcxBjqi0QBTWEUCg0d1ByYaaQA5DD0ABG91BcBLZQA76DEAqGt9B\neKSsQMF0IkBV38hBMuCVQEeGJkCn9+lBGjeOQOzIOkBt5MtBbzisQCuZO0CePeRBXjKFQBeV\nMEDx6dlB3HnRQDoaFUC+391Bx0KkQBSwHEC1qOpBBSnKQDV+HEAsXuRBMuzbQCtJI0AE6dpB\nnICIQLuHO0BeVddBQzeCQEKkE0DgEeBBlz/WQJ30EUD/2/dBe765QISoIkCO3txBtMa0QBNS\nKEC7HdBBJTSfQJEeIkAYse5Bl8GnQGcqPECpDOpBowSiQIlGNEBY3/FBgTGgQDmEA0BBY99B\no2K/QGIONUBKxtxBJ2K/QBxUNkBbHu1BSMOsQARDBkA/nu9BVcPOQGaJBkBfB9RBhi/DQDOH\nEkC35NhBTDwFQXg5GkChaehBusXoQLUvHEC/bvZB+be9QOCnH0Dqq+BBQiDvQDLAOEBcZM1B\nvcu8QFezMkAURd1BXkvIQIKhF0CROM1B4avnQEaLHEBQSd1BzxnhQBd7GEDduN9BtnPPQOeV\nN0DcIvFBVVb+QMhTP0C4fPBBXU3KQFyuPkCev8pBJSAHQbh+NECLIuNB03/MQKjbLkBAWs5B\nFP33QHdDLkAqYvZBaSf8QBW1H0DtEN5B+RUEQYNiM0C+d8lBijHSQEqwF0AF4+BBvdPKQHOb\nE0AwX89BnkDxQI4OAECeyOBBeUjwQA3eO0DvgcpB+JTgQIcvA0CHz9RBNS7HQKjPA0CZi9dB\nuPnrQMLoAkCBmPBB90H/QOvYKEBqwtRBut/ZQOk+F0Api/BBshmwQDsHFkANyeRBI//dQCHg\nIEAUGO9B8Rj5QCLIA0BQz8hBKA/GQC1VIkCvXfNB7t8DQQYuK0C9OctB5J6/QLszEkBnKdBB\nnerGQI4DGEAec85BD9jqQAHvDUC3bvBBm++2QNR4F0CJkvFB7k/6QAziA0BdtsxBEazgQEtw\nBEAFNtpB2T/dQEp+FUAZkNRBlcLOQIlnG0CPQOZBGB6zQLNzIECow/RBZ8u9QFknBEBzF9BB\nbYXYQC79JkBgxe1BXPbqQMdLDEAFE9dBeV7BQP6cBEAMzd5BgZ+5QBEwCEALWdpBlnLwQNJ4\nKUC5H9RBuTnQQGCkDUBMM+9BnFwFQdZrKEDWDO1BWu3XQGl/PkDvke9BWHUAQXZsK0AQtdtB\n/5e/QNBsLUBfSttBYVveQMD4NECcS85BrOHrQOdxOEDuu9RBT9/EQI8mN0CEyudBpBLfQCXO\nD0CCO+5BwjoBQbjiJEAwAetB+0sFQXxBG0DkuNZB2N67QGjGLEAZLt1BLzvoQFYcBUD4o+tB\nAtb6QLUFnECJjdtBh0u4QNuwmEAh+O5BSs/9QA2Jn0DXQN9BJ57NQGlwk0B5pfRB2H7AQH4p\nhkDxJspBbl/2QDZ4jEAwG+JBj0ffQDF1hkBtMedBG3uwQC2ihEDOPt1BMgDXQF5ZiEC5fcxB\nO9q2QG8fk0CtNs1B8lbGQImig0DavvRBZtnpQHU3mUCm2tdBCVbNQDlDi0DsKslB1+PRQL6R\nmEDo0c1BS/vFQA35lUBAyfdBJtsGQQotmkCdsN1B3uW+QPOsmEApkcpBPqzMQLeziUCDAd1B\nGATgQIo/mkBfGs1BxmfRQNNXnkCe5dZBpVruQB4MlkAe+9BBiL6/QPKWlUDd4etBFV0CQf2S\nhkBqB/JB4BIHQa25m0AXieBB/nzyQGfdiEBxbtVBP125QFp7nEAXD9hB2nLCQJD5jkCp+vRB\nAFnkQDvDgkA5Pc5Bt6feQLRngkCY1OxByU68QB4mi0Ay+/FBSHb//0h2//9Idv//SHb//0h2\n//9Idv//SHb//0h2//9Idv//SHb//0h2//9Idv//SHb//0h2//9Idv//SHb//0h2//9Idv//\nSHb//0h2//9Idv//SHb//0h2//9Idv//SHb//0h2//9Idv//SHb//0h2//9Idv//AIuL/wCL\ni/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/\nAIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCLi/8Ai4v/AIuL/wCL\ni/8Ai4v//fXm//315v/99eb//fXm//315v/99eb//fXm//315v/99eb//fXm//315v/99eb/\n/fXm//315v/99eb//fXm//315v/99eb//fXm//315v/99eb//fXm//315v/99eb//fXm//31\n5v/99eb//fXm//315v/99eb//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/UeOzQCeTHUBD2OtB59OfQP55G0DJ4eJB\nZo+YQAeDJEDYCNpBD5XJQC86BEDXZM9B9qjPQIizOUDCsMlB1SW5QA32KUDVMcxBjqi0QBTW\nEUCg0d1ByYaaQA5DD0ABG91BcBLZQA76DEAqGt9BeKSsQMF0IkBV38hBMuCVQEeGJkCn9+lB\nGjeOQOzIOkBt5MtBbzisQCuZO0CePeRBXjKFQBeVMEDx6dlB3HnRQDoaFUC+391Bx0KkQBSw\nHEC1qOpBBSnKQDV+HEAsXuRBMuzbQCtJI0AE6dpBnICIQLuHO0BeVddBQzeCQEKkE0DgEeBB\nlz/WQJ30EUD/2/dBe765QISoIkCO3txBtMa0QBNSKEC7HdBBJTSfQJEeIkAYse5Bl8GnQGcq\nPECpDOpBowSiQIlGNEBY3/FBgTGgQDmEA0BBY99Bo2K/QGIONUBKxtxBJ2K/QBxUNkBbHu1B\nSMOsQARDBkA/nu9BVcPOQGaJBkBfB9RBhi/DQDOHEkC35NhBTDwFQXg5GkChaehBusXoQLUv\nHEC/bvZB+be9QOCnH0Dqq+BBQiDvQDLAOEBcZM1Bvcu8QFezMkAURd1BXkvIQIKhF0CROM1B\n4avnQEaLHEBQSd1BzxnhQBd7GEDduN9BtnPPQOeVN0DcIvFBVVb+QMhTP0C4fPBBXU3KQFyu\nPkCev8pBJSAHQbh+NECLIuNB03/MQKjbLkBAWs5BFP33QHdDLkAqYvZBaSf8QBW1H0DtEN5B\n+RUEQYNiM0C+d8lBijHSQEqwF0AF4+BBvdPKQHObE0AwX89BnkDxQI4OAECeyOBBeUjwQA3e\nO0DvgcpB+JTgQIcvA0CHz9RBNS7HQKjPA0CZi9dBuPnrQMLoAkCBmPBB90H/QOvYKEBqwtRB\nut/ZQOk+F0Api/BBshmwQDsHFkANyeRBI//dQCHgIEAUGO9B8Rj5QCLIA0BQz8hBKA/GQC1V\nIkCvXfNB7t8DQQYuK0C9OctB5J6/QLszEkBnKdBBnerGQI4DGEAec85BD9jqQAHvDUC3bvBB\nm++2QNR4F0CJkvFB7k/6QAziA0BdtsxBEazgQEtwBEAFNtpB2T/dQEp+FUAZkNRBlcLOQIln\nG0CPQOZBGB6zQLNzIECow/RBZ8u9QFknBEBzF9BBbYXYQC79JkBgxe1BXPbqQMdLDEAFE9dB\neV7BQP6cBEAMzd5BgZ+5QBEwCEALWdpBlnLwQNJ4KUC5H9RBuTnQQGCkDUBMM+9BnFwFQdZr\nKEDWDO1BWu3XQGl/PkDvke9BWHUAQXZsK0AQtdtB/5e/QNBsLUBfSttBYVveQMD4NECcS85B\nrOHrQOdxOEDuu9RBT9/EQI8mN0CEyudBpBLfQCXOD0CCO+5BwjoBQbjiJEAwAetB+0sFQXxB\nG0DkuNZB2N67QGjGLEAZLt1BLzvoQFYcBUD4o+tBAtb6QLUFnECJjdtBh0u4QNuwmEAh+O5B\nSs/9QA2Jn0DXQN9BJ57NQGlwk0B5pfRB2H7AQH4phkDxJspBbl/2QDZ4jEAwG+JBj0ffQDF1\nhkBtMedBG3uwQC2ihEDOPt1BMgDXQF5ZiEC5fcxBO9q2QG8fk0CtNs1B8lbGQImig0DavvRB\nZtnpQHU3mUCm2tdBCVbNQDlDi0DsKslB1+PRQL6RmEDo0c1BS/vFQA35lUBAyfdBJtsGQQot\nmkCdsN1B3uW+QPOsmEApkcpBPqzMQLeziUCDAd1BGATgQIo/mkBfGs1BxmfRQNNXnkCe5dZB\npVruQB4MlkAe+9BBiL6/QPKWlUDd4etBFV0CQf2ShkBqB/JB4BIHQa25m0AXieBB/nzyQGfd\niEBxbtVBP125QFp7nEAXD9hB2nLCQJD5jkCp+vRBAFnkQDvDgkA5Pc5Bt6feQLRngkCY1OxB\nyU68QB4mi0Ay+/FBAADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAPwAAwH8AAIBAAACAPwAA\nAAEAAMB/AACAQAAAgD8AAMB/AACAQAAAgD8AAAABAADAfwAAgEAAAIA/mZiYPpmYmD6ZmJg+\nAACAPwAAAAEBAQEAAAAAAAAAgEAAAMB/AADAfwAAoEAAAMB/AADAfwAAwEAAAMB/AADAfwAA\n4EAAAMB/AADAfwAAAEEAAMB/AADAfwAAwH8AAABAAADAfwAAwH8AACBAAADAfwAAwH8AAEBA\nAADAfwAAwH8AAGBAAADAfwAAwH8AAIBAAADAfwAAwH8AAJBAAADAfwAAwH8AAKBAAADAfwAA\nwH8AAMB/AADIQQAAwH8AAMB/AADQQQAAwH8AAMB/AADYQQAAwH8AAMB/AADgQQAAwH8AAMB/\nAADoQQAAwH8AAMB/AADwQQAAwH8AAMB/AAD4QQAAAAE="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n    \n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n#ifdef TEXTURE_rgb\n    vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n#endif\n    \n#ifdef TEXTURE_rgba\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef TEXTURE_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n    textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n    \n#ifdef TEXTURE_luminance\n    vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n#endif\n    \n#ifdef TEXTURE_luminance_alpha\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n    textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n#endif\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz de correlaci√≥n</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(df_numericas) </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># representa la matriz de correlaciones mediante c√≠rculos</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(m_cor,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag=</span> <span class="cn">FALSE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="matriz-de-varianzas-y-covarianzas" class="level1">
<h1>Matriz de Varianzas y covarianzas</h1>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>m_cov <span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">cov</span>(df_numericas),<span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>m_cov</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Petalo Internodal Sepalo Bractea Peciolo  Hoja Fruto
Petalo       1.05      -0.08   0.12   -0.05   -0.44  0.12 -0.01
Internodal  -0.08       3.01  -0.06   -0.08    0.09  0.06  0.05
Sepalo       0.12      -0.06   0.87   -0.02    0.15 -0.08 -0.02
Bractea     -0.05      -0.08  -0.02    0.77    0.05 -0.05  0.01
Peciolo     -0.44       0.09   0.15    0.05    1.13  0.05  0.06
Hoja         0.12       0.06  -0.08   -0.05    0.05  0.31  0.00
Fruto       -0.01       0.05  -0.02    0.01    0.06  0.00  0.08</code></pre>
</div>
</div>
<p>Las varianzas tienen distintas unidades: No son comparables!!</p>
<p>Y la traza??</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>traza_cov  <span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(m_cov))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>traza_cov</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.22</code></pre>
</div>
</div>
<p>La funci√≥n <code>eigen()</code> calcula los autovectores y autovalores y los almacena en una lista bajo el nombre de <em>vectors</em> y <em>values</em>, respectivamente.</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m_cov <span class="ot">&lt;-</span> <span class="fu">eigen</span>(m_cov)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>autovalores_cov <span class="ot">&lt;-</span> m_cov<span class="sc">$</span>values <span class="co">#autovalores</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(autovalores_cov, <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.03 1.54 0.98 0.76 0.61 0.24 0.07</code></pre>
</div>
</div>
<p>Y si estandarizo los datos?</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>datos_estandarizados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(df_numericas))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculo la matriz de covarianzas en los datos estandarizados</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cov</span>(datos_estandarizados),<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Petalo Internodal Sepalo Bractea Peciolo  Hoja Fruto
Petalo       1.00      -0.05   0.13   -0.06   -0.41  0.21 -0.04
Internodal  -0.05       1.00  -0.04   -0.05    0.05  0.07  0.11
Sepalo       0.13      -0.04   1.00   -0.02    0.15 -0.15 -0.06
Bractea     -0.06      -0.05  -0.02    1.00    0.05 -0.11  0.04
Peciolo     -0.41       0.05   0.15    0.05    1.00  0.09  0.21
Hoja         0.21       0.07  -0.15   -0.11    0.09  1.00 -0.03
Fruto       -0.04       0.11  -0.06    0.04    0.21 -0.03  1.00</code></pre>
</div>
</div>
</section>
<section id="matriz-de-correlaciones" class="level1">
<h1>Matriz de Correlaciones</h1>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">cor</span>(df_numericas),<span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>m_cor</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Petalo Internodal Sepalo Bractea Peciolo  Hoja Fruto
Petalo       1.00      -0.05   0.13   -0.06   -0.41  0.21 -0.04
Internodal  -0.05       1.00  -0.04   -0.05    0.05  0.07  0.11
Sepalo       0.13      -0.04   1.00   -0.02    0.15 -0.15 -0.06
Bractea     -0.06      -0.05  -0.02    1.00    0.05 -0.11  0.04
Peciolo     -0.41       0.05   0.15    0.05    1.00  0.09  0.21
Hoja         0.21       0.07  -0.15   -0.11    0.09  1.00 -0.03
Fruto       -0.04       0.11  -0.06    0.04    0.21 -0.03  1.00</code></pre>
</div>
</div>
<p>Y la traza?</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>traza_cor  <span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(m_cor))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>traza_cor</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
<p>Traza = p (n√∫mero de variables)</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>desc_mat_cor <span class="ot">&lt;-</span><span class="fu">eigen</span>(m_cor)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>autovalores_cor <span class="ot">&lt;-</span>desc_mat_cor<span class="sc">$</span>values</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(autovalores_cor,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.53 1.23 1.08 0.98 0.95 0.86 0.37</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">round</span>(autovalores_cor)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">round</span>(autovalores_cov,<span class="dv">2</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.23</code></pre>
</div>
</div>
<p><strong>Conclusi√≥n</strong>:la suma de los autovalores de cada matriz coincide con su respectiva traza</p>
<section id="que-matriz-usar-para-extraer-a-los-componentes" class="level2">
<h2 class="anchored" data-anchor-id="que-matriz-usar-para-extraer-a-los-componentes">¬øQue matriz usar para extraer a los componentes?</h2>
<p><strong>Matriz de varianzas y covarianzas</strong></p>
<ul>
<li><p>Cuando las variables est√°n en la misma escala</p></li>
<li><p>Da m√°s peso a las variables con mayor varianza</p></li>
<li><p>En la interpretaci√≥n interesa la diferencia entre varianzas</p></li>
</ul>
<p><strong>Matriz de correlaci√≥n</strong>:</p>
<ul>
<li><p>Cuando las variables est√°n en distintas escalas o con valores muy distintos</p></li>
<li><p>Da el mismo peso a todas las variables</p></li>
</ul>
</section>
</section>
<section id="pca" class="level1">
<h1>PCA</h1>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#varianza de las variables</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> df_numericas, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN =</span> <span class="dv">2</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> var)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Petalo Internodal     Sepalo    Bractea    Peciolo       Hoja      Fruto 
1.05391169 3.00918498 0.87055111 0.77307001 1.12809916 0.30613080 0.08083453 </code></pre>
</div>
</div>
<p>Por defecto, <code>prcomp()</code> centra las variables para que tengan media cero, pero si se quiere adem√°s que su desviaci√≥n est√°ndar sea de uno, hay que indicar <em>scale = TRUE</em>.</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df_numericas,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pca)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sdev"     "rotation" "center"   "scale"    "x"       </code></pre>
</div>
</div>
<p><code>center</code>:contienen la media de las variables previa estandarizaci√≥n (en la escala original)</p>
<p><code>scale</code>: contienen desviaci√≥n t√≠pica de las variables previa estandarizaci√≥n (en la escala original)</p>
<p><code>rotation</code>: contiene los <em>loadings</em></p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             PC1   PC2   PC3   PC4   PC5   PC6   PC7
Petalo      0.62 -0.09 -0.22  0.42 -0.25  0.04 -0.57
Internodal -0.15 -0.46 -0.09  0.39  0.55 -0.55 -0.04
Sepalo     -0.02  0.41 -0.79  0.18 -0.06 -0.17  0.37
Bractea    -0.18  0.32  0.43  0.38 -0.50 -0.52  0.06
Peciolo    -0.63 -0.11 -0.33 -0.21 -0.29 -0.08 -0.59
Hoja        0.18 -0.65 -0.14 -0.25 -0.52 -0.21  0.39
Fruto      -0.36 -0.27  0.00  0.62 -0.16  0.59  0.21</code></pre>
</div>
</div>
<p>¬øCu√°l seria la combinaci√≥n lineal de la primer componente?</p>
<p><span class="math inline">\(\ PC1= 0.62*Petalo- 0.15*Internodal - 0.02*Sepalo -0.18*Bractea -0.63*Peciolo +0.18*Hoja -0.36*Hoja\)</span></p>
<p>Y de la segunda componente (PCA2)??</p>
<section id="loadings" class="level2">
<h2 class="anchored" data-anchor-id="loadings"><em>Loadings</em></h2>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loadings</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>carga1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_numericas),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">primeracarga=</span><span class="fu">data.frame</span>(pca<span class="sc">$</span>rotation)[,<span class="dv">1</span>]))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>carga2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_numericas),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">segundacarga=</span><span class="fu">data.frame</span>(pca<span class="sc">$</span>rotation)[,<span class="dv">2</span>]))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(carga1,carga2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  X primeracarga X segundacarga
1 1   0.62197308 1  -0.08929246
2 2  -0.14616202 2  -0.46151428
3 3  -0.01901835 3   0.40986759
4 4  -0.17607514 4   0.32192813
5 5  -0.63323621 5  -0.11436469
6 6   0.17920062 6  -0.64904503
7 7  -0.35682074 7  -0.27030267</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(carga1, <span class="fu">aes</span>(<span class="fu">colnames</span>(df_numericas) ,primeracarga)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_bar</span> (<span class="at">stat=</span><span class="st">"identity"</span> , </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">position=</span><span class="st">"dodge"</span> ,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span><span class="st">"royalblue"</span> ,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span><span class="fl">0.5</span> ) <span class="sc">+</span> <span class="fu">xlab</span>( <span class="st">'Variables'</span> ) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Primera carga'</span> )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="autovalores" class="level2">
<h2 class="anchored" data-anchor-id="autovalores">Autovalores</h2>
<p>¬øQu√© proporci√≥n de la variabilidad total es explicada por las componentes?</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="co"># autovalores</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5210491 1.2287897 1.0810979 0.9847637 0.9486495 0.8629174 0.3727327</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>prop_varianza <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>prop_varianza</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.21729273 0.17554138 0.15444256 0.14068053 0.13552136 0.12327391 0.05324753</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(prop_varianza, <span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pc, <span class="at">y =</span> prop_varianza)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Componente principal"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Prop. de varianza explicada"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="biplot" class="level2">
<h2 class="anchored" data-anchor-id="biplot">Biplot</h2>
<ul>
<li><p>Los objetos son ordenados en funci√≥n de su puntaje en cada uno de los componentes analizados</p></li>
<li><p>Las variables son representadas como vectores</p></li>
</ul>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(<span class="at">x =</span> pca, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue4"</span>, <span class="st">"brown3"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Mejoremos la visualizaci√≥n</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Poblacion'</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="01_pca_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vizualicemos las primeras 3 componentes:</p>
<div class="cell">
<details open="">
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">&lt;-</span> pca[[<span class="st">"x"</span>]]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(componentes)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">=</span> <span class="fu">cbind</span>(componentes, df<span class="sc">$</span>Poblacion)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>titulo <span class="ot">=</span> <span class="st">'Primeras 3 CPs'</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(componentes, </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="sc">~</span>PC1, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="sc">~</span>PC2, </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">z =</span> <span class="sc">~</span>PC3, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>df<span class="sc">$</span>Poblacion,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#636EFA'</span>,<span class="st">'#EF553B'</span>,<span class="st">'#00CC96'</span>) ) <span class="sc">|&gt;</span> </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_markers</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">|&gt;</span> </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> titulo,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">bgcolor =</span> <span class="st">"#f3f2fc"</span>)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-498b60a85453e2a4dea6" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-498b60a85453e2a4dea6">{"x":{"visdat":{"3fac241572a8":["function () ","plotlyVisDat"]},"cur_data":"3fac241572a8","attrs":{"3fac241572a8":{"x":{},"y":{},"z":{},"color":{},"colors":["#636EFA","#EF553B","#00CC96"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","size":12,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Primeras 3 CPs","scene":{"bgcolor":"#f3f2fc","xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-2.18908241001188,-1.1311220287935,-2.25898235000524,-1.40445435890004,-0.0744212947609665,-0.841657977951664,-0.57200970023003,-1.09106572708869,-0.788824180004533,-1.95769997178528,-3.22026772515163,-1.77802761868884,-0.56488870940325,-2.6340967030209,-0.162503557532708,-2.24388494041296,-1.55668081687394,-0.682275510034527,-3.47486031273852,-1.95688217589354,-0.368079936087625,-1.65544601680881,-1.34132119803871,-1.83237357447245,-1.19250681682029,-1.79715686310833,-1.82977777448722,-1.1127170323325,-0.264639009284897,-2.36901916389324],"y":[-0.418310363449322,0.470842614430806,1.02346622742309,-0.0735402914873168,-0.0582604140075261,-0.60679757066398,0.303737685896055,1.01602436794944,0.214497170529754,1.71261654882856,-0.399786483637934,0.96311704081275,0.116837937218076,0.266554478546482,-0.63347338100634,0.00503504672209426,-0.570724679385477,0.140236911808175,0.979391251825634,0.482293035922333,-0.954815582927687,1.1032724916216,0.669071405688934,-0.463309755032339,0.619306954182552,-1.75939446646283,-0.326788695422074,-0.0529592278669617,-0.95653944440908,-0.564349197132309],"z":[0.176047830601134,0.176654218398786,1.24444881517793,0.350999827300184,-0.420094080727844,-0.366964617769989,0.745931481618669,1.59486970056889,1.19339183192347,0.982961327441512,0.400029155716675,1.03643263592995,-0.349178042487212,0.10284905759921,-0.405833128958141,0.859967337464165,0.0451866738007147,0.307011952598041,0.662269757168434,0.973795933071338,0.889700205962725,1.23480603402472,0.6531604233486,0.0550827600947739,0.481523195731265,-0.595145159473204,0.856826296326722,0.407693888127109,-0.621234159138461,0.864657470309781],"type":"scatter3d","mode":"markers","name":"I","marker":{"color":"rgba(99,110,250,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(99,110,250,1)"}},"textfont":{"color":"rgba(99,110,250,1)","size":55},"error_y":{"color":"rgba(99,110,250,1)","width":55},"error_x":{"color":"rgba(99,110,250,1)","width":55},"line":{"color":"rgba(99,110,250,1)","width":55},"frame":null},{"x":[0.616422979181642,-0.312718255643125,0.872048184608569,1.23320658284471,0.506389078921587,1.91621490097878,0.286888469536854,0.473180149527128,0.929330062454655,1.7611411375688,0.630596974505317,1.77223518646551,1.05627444591531,1.47293286326234,0.570808134846134,1.03858709354804,1.78377871820668,2.93753647690595,-0.0324556970059036,2.21326882825307,1.50112630375642,0.996480381410002,-0.162736692162303,0.812644559570784,1.70378525957263,1.52515735084029,1.06380461309954,0.139238367385544,0.633539561014003,2.26065605405923],"y":[0.140312994930972,0.762101844975398,-0.765299886121831,-0.595621474784934,0.265365360632652,1.57386921797449,1.39269949355652,0.696265000505597,0.0870910310688016,0.505238735163947,-0.598306369347159,0.586056402639166,1.68442955249546,-0.21410852762831,0.106495411720074,0.605646948107318,0.53444171232517,1.02423865913024,0.186857463684031,0.754787108198723,0.311291487670707,1.42071439115519,0.093858950391067,0.641527481260822,-0.892834352657318,0.290751338965394,-0.843592237320579,-0.249256981207277,0.422247175254198,1.97331236905334],"z":[1.25406727013738,1.57350217899307,0.0669608207987663,0.10888357140756,0.740717109831751,0.830568029860796,1.24579306578544,1.00817736437168,0.0986936013012158,1.0960970516297,-0.622998822337139,0.714633983245236,1.34033501001401,1.02171939645253,0.201307627073718,0.970822765134276,0.879893980663225,0.283379442024867,1.13028198287179,1.62667397818679,0.865067016752527,-0.0447282233328644,1.54591087872982,1.2640088902032,0.92218549778271,0.137529047671708,0.531943743913426,1.15510927885173,1.06603996100482,2.30726453147307],"type":"scatter3d","mode":"markers","name":"II","marker":{"color":"rgba(215,93,123,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(215,93,123,1)"}},"textfont":{"color":"rgba(215,93,123,1)","size":55},"error_y":{"color":"rgba(215,93,123,1)","width":55},"error_x":{"color":"rgba(215,93,123,1)","width":55},"line":{"color":"rgba(215,93,123,1)","width":55},"frame":null},{"x":[-0.862154049219071,1.50326429078568,0.660285834054946,0.00923158585816242,-0.0660832219542402,-0.131686852598071,1.19025924214895,1.45769565591907,0.35504868215773,0.994596689442813,-0.17863897758571,-0.353822019574732,-0.71255907245155,0.606132408544149,0.145084866802421,0.55457463067457,0.24438536619705,-0.222227906031467,1.62281048463056,-0.329009677279003,2.05948144646261,-0.163582313713013,1.07454280517361,1.5895877248474,0.772921806696857,1.29299933338837,1.07176462089841,0.550186352658495,0.0509819375126123,-0.450590608811822],"y":[-2.06609056281911,-0.865857316774984,-0.327919539609783,0.639675775297913,-1.64990160314075,-1.69486168016976,-0.967060868666622,-1.38595189263152,-0.297412397061172,-1.88627146392443,-1.93767135189858,-1.21183615615267,-2.57046776124775,-0.0625826212278593,-0.579551103991842,-1.02641742347572,-0.778508023970854,-2.19209440578856,-1.57147600880333,-2.18885140885451,-0.970039201904666,-1.13356949954681,-0.512433600979704,-0.577285115865994,-1.59740306251389,-2.3914265066963,-2.14558539324978,-1.77295459603297,-0.566695756119762,-2.7524678193996],"z":[-0.312464196600805,-0.410582770392099,0.425157051673643,1.27878703416357,0.743369403210702,0.0666165257782394,-0.13971198816912,0.21065221089928,0.0425329560461948,-0.0520144129082637,-0.243634607039511,0.66603416693182,-0.356129961776219,0.892670430304636,1.18968575430609,0.317426140939074,0.191238585648519,0.482138885433483,0.0921970036596924,-0.331991575872923,0.178443317485959,-0.224346206395652,0.0646335638729577,0.00270879795717108,-0.666910345157662,-0.247549553586916,-0.147921511720657,-0.632517199952058,0.203086220876313,-0.00787356691466278],"type":"scatter3d","mode":"markers","name":"III","marker":{"color":"rgba(202,136,88,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(202,136,88,1)"}},"textfont":{"color":"rgba(202,136,88,1)","size":55},"error_y":{"color":"rgba(202,136,88,1)","width":55},"error_x":{"color":"rgba(202,136,88,1)","width":55},"line":{"color":"rgba(202,136,88,1)","width":55},"frame":null},{"x":[0.777876969569969,-1.27646963394834,0.804963009149807,-1.22413044127521,-0.0712887385561563,-0.211738981049032,-0.538045571766688,-1.51646799081488,0.377564785999743,0.2461498208662,-0.712099596085123,0.143753573094919,-0.544059552123444,1.26320743526869,-0.665740484521109,1.21993886155727,0.400680896935425,0.221575257421278,-0.168553697668772,0.314076524572014,0.110682814673303,-1.01700842373793,-0.327890327021969,1.77793045565799,-0.443730746201677,-0.996665643564612,-0.403681980584687,0.15951772573222,0.19013058141705,-0.0785945874434399],"y":[1.76171366154267,0.579590353028709,0.427632602340596,0.12962437448659,2.28224513900176,1.03744050994714,-0.0672542681097979,0.744196951041814,1.89493111271558,2.08316993587326,0.237284544129177,0.0335782822787769,1.56593098160207,1.7274613971544,-0.276763433501935,0.719158877400813,0.987348208181831,0.443335100723698,1.55068855848558,2.3875535099704,0.678268784084764,-0.54298570484173,-0.0853744198912585,0.694386649124258,0.36785182598095,0.7845813457608,0.424728814333843,0.826705773041736,0.192884935235443,1.30322204779244],"z":[-1.39647936205715,-1.13994937478834,-2.98264323602877,-0.939590847862057,-0.176863250201587,-0.901736970916243,-1.75862507267022,-0.975305047617717,-0.545823399972268,-1.12506317806811,-1.05452161374262,-2.250425085429,-0.620097038891571,-1.52875402080786,-1.37713665909173,-2.2344157849227,-1.6736339760264,-1.74724608842031,-1.84547747529556,-0.685403217785012,-2.30993669356231,-2.11427940711046,-1.7809144790822,-2.35189276694756,-1.06865220544912,-2.08223936667597,-0.498432172506208,-0.838393126356167,-1.52993445300876,-0.597553433653551],"type":"scatter3d","mode":"markers","name":"IV","marker":{"color":"rgba(0,204,150,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","line":{"color":"rgba(0,204,150,1)"}},"textfont":{"color":"rgba(0,204,150,1)","size":55},"error_y":{"color":"rgba(0,204,150,1)","width":55},"error_x":{"color":"rgba(0,204,150,1)","width":55},"line":{"color":"rgba(0,204,150,1)","width":55},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>¬øC√≥mo interpretamos el biplot?</p>
<p>¬øCon cu√°ntas componentes nos quedamos? Lo vemos la pr√≥xima clase.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el c√≥digo</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "An√°lisis de Componentes Principales"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pamela E. Pairo"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> es</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:  flatly</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gsheet)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot3D)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>**Contexto**</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>Hay bastante heterogeneidad entre los individuos de una planta de baja capacidad dispersiva que crece en valles intermontanos.Los investigadores del asunto desean saber si pueden describir esa heterogeneidad con un n√∫mero menor de dimensiones que las 7 caracter√≠sticas vegetativas y reproductivas que midieron.</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>Partes de una flor</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="al">![](https://i.pinimg.com/originals/e5/3b/78/e53b7858a464dfb20738473fff0c19f5.jpg)</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>Internodo</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="al">![](https://images.vexels.com/media/users/3/202454/raw/a6f138847ef867363d9afb3d13b2e792-diseno-de-anatomia-de-plantas-de-flores.jpg)</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co">#Carga de la base de datos</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span><span class="fu">read.delim2</span>(<span class="st">"plantas.txt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="st">'Poblacion'</span>, as.factor) <span class="sc">|&gt;</span> </span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.numeric))</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>**Objetivo del PCA**</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>Reducir el n√∫mero de variables generando **nuevas variables que resuman la informaci√≥n original**. Revelar patrones en los datos que pueden no ser detectados al analizar las variables por separado.</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>Petalo, <span class="at">y=</span>Internodal)) <span class="sc">+</span> </span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">colour=</span><span class="st">'#56B4E9'</span>, <span class="at">shape=</span><span class="dv">19</span>)<span class="sc">+</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Largo Petalo"</span>)<span class="sc">+</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Largo S√©palo"</span>)<span class="sc">+</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>Trabajamos unicamente con las variables num√©ricas.</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>df_numericas <span class="ot">&lt;-</span>df <span class="sc">|&gt;</span> </span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>Todos contra todos</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>gpairs_lower <span class="ot">&lt;-</span> <span class="cf">function</span>(g){</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>plots <span class="ot">&lt;-</span> g<span class="sc">$</span>plots[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>g<span class="sc">$</span>nrow)]</span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>yAxisLabels <span class="ot">&lt;-</span> g<span class="sc">$</span>yAxisLabels[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>nrow <span class="ot">&lt;-</span> g<span class="sc">$</span>nrow <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>plots <span class="ot">&lt;-</span> g<span class="sc">$</span>plots[<span class="sc">-</span>(<span class="fu">seq</span>(g<span class="sc">$</span>ncol, <span class="fu">length</span>(g<span class="sc">$</span>plots), <span class="at">by =</span> g<span class="sc">$</span>ncol))]</span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>xAxisLabels <span class="ot">&lt;-</span> g<span class="sc">$</span>xAxisLabels[<span class="sc">-</span>g<span class="sc">$</span>ncol]</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>  g<span class="sc">$</span>ncol <span class="ot">&lt;-</span> g<span class="sc">$</span>ncol <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>  g</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span><span class="fu">ggpairs</span>(df_numericas, </span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">color =</span> df<span class="sc">$</span>Poblacion, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>, <span class="at">combo =</span> <span class="st">"dot"</span>), </span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper  =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"blank"</span>), <span class="at">legend =</span> <span class="dv">1</span>)<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="fu">gpairs_lower</span>(g)</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(df)  </span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value, <span class="at">fill=</span> Poblacion)) <span class="sc">+</span> </span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>**Representaci√≥n tridimensional de variables**</span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter3D</span>(df<span class="sc">$</span>Petalo, df<span class="sc">$</span>Sepalo, df<span class="sc">$</span>Internodal, </span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>          <span class="at">phi =</span> <span class="dv">0</span>, </span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>          <span class="at">bty =</span> <span class="st">"g"</span>,</span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a>          <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="dv">2</span>, </span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>          <span class="at">ticktype =</span> <span class="st">"detailed"</span>, </span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>          <span class="at">colvar=</span><span class="cn">NULL</span>, </span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">"blue"</span>,</span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">"Petalo"</span>,</span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">"Sepalo"</span>,</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab=</span><span class="st">"Internodal"</span>)</span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'royalblue1'</span>, <span class="st">'darkcyan'</span>, <span class="st">'oldlace'</span>, <span class="st">'red'</span>)</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>color <span class="ot">&lt;-</span> mycolors[ <span class="fu">as.numeric</span>(df<span class="sc">$</span>Poblacion) ]</span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(df<span class="sc">$</span>Petalo, df<span class="sc">$</span>Sepalo, df<span class="sc">$</span>Internodal, </span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">'s'</span>, </span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a>          <span class="at">radius =</span> .<span class="dv">1</span>,</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> df<span class="sc">$</span>color,</span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab=</span><span class="st">"Petalo"</span>,</span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab=</span><span class="st">"Sepalo"</span>,</span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a>          <span class="at">zlab=</span><span class="st">"Internodal"</span>)</span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="fu">rglwidget</span>()</span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz de correlaci√≥n</span></span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(df_numericas) </span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a><span class="co"># representa la matriz de correlaciones mediante c√≠rculos</span></span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(m_cor,</span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"circle"</span>,</span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag=</span> <span class="cn">FALSE</span>) </span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a><span class="fu"># Matriz de Varianzas y covarianzas</span></span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a>m_cov <span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">cov</span>(df_numericas),<span class="dv">2</span>)</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>m_cov</span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>Las varianzas tienen distintas unidades: No son comparables!!</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>Y la traza??</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>traza_cov  <span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(m_cov))</span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>traza_cov</span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>La funci√≥n <span class="in">`eigen()`</span> calcula los autovectores y autovalores y los almacena en una lista bajo el nombre de _vectors_ y _values_, respectivamente.</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a>m_cov <span class="ot">&lt;-</span> <span class="fu">eigen</span>(m_cov)</span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a>autovalores_cov <span class="ot">&lt;-</span> m_cov<span class="sc">$</span>values <span class="co">#autovalores</span></span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(autovalores_cov, <span class="dv">2</span>)</span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>Y si estandarizo los datos?</span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a>datos_estandarizados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">scale</span>(df_numericas))</span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a><span class="co">#calculo la matriz de covarianzas en los datos estandarizados</span></span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cov</span>(datos_estandarizados),<span class="dv">2</span>)</span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a><span class="fu"># Matriz de Correlaciones</span></span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">cor</span>(df_numericas),<span class="dv">2</span>)</span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a>m_cor</span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a>Y la traza?</span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a>traza_cor  <span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(m_cor))</span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a>traza_cor</span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>Traza = p (n√∫mero de variables)</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>desc_mat_cor <span class="ot">&lt;-</span><span class="fu">eigen</span>(m_cor)</span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>autovalores_cor <span class="ot">&lt;-</span>desc_mat_cor<span class="sc">$</span>values</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(autovalores_cor,<span class="dv">2</span>)</span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">round</span>(autovalores_cor)))</span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">round</span>(autovalores_cov,<span class="dv">2</span>)))</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a>**Conclusi√≥n**:la suma de los autovalores de cada matriz coincide con su respectiva traza</span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a><span class="fu">## ¬øQue matriz usar para extraer a los componentes?</span></span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a>**Matriz de varianzas y covarianzas**</span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cuando las variables est√°n en la misma escala</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Da m√°s peso a las variables con mayor varianza</span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>En la interpretaci√≥n interesa la diferencia entre varianzas</span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a>**Matriz de correlaci√≥n**:</span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cuando las variables est√°n en distintas escalas o con valores muy distintos</span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Da el mismo peso a todas las variables</span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a><span class="fu"># PCA</span></span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a><span class="co">#varianza de las variables</span></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> df_numericas, </span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN =</span> <span class="dv">2</span>, </span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> var)</span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a>Por defecto, <span class="in">`prcomp()`</span> centra las variables para que tengan media cero, pero si se quiere adem√°s que su desviaci√≥n est√°ndar sea de uno, hay que indicar *scale = TRUE*.</span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df_numericas,</span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pca)</span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a><span class="in">`center`</span>:contienen la media de las variables previa estandarizaci√≥n (en la escala original)</span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a><span class="in">`scale`</span>: contienen desviaci√≥n t√≠pica de las variables previa estandarizaci√≥n (en la escala original)</span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a><span class="in">`rotation`</span>: contiene los *loadings*</span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>)</span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a>¬øCu√°l seria la combinaci√≥n lineal de la primer componente?</span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a>$\ PC1= 0.62*Petalo- 0.15*Internodal - 0.02*Sepalo -0.18*Bractea -0.63*Peciolo +0.18*Hoja -0.36*Hoja$</span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>Y de la segunda componente (PCA2)??</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a><span class="fu">## _Loadings_</span></span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE}</span></span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a><span class="co">#loadings</span></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>carga1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_numericas),</span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a>                          <span class="at">primeracarga=</span><span class="fu">data.frame</span>(pca<span class="sc">$</span>rotation)[,<span class="dv">1</span>]))</span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a>carga2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">X=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df_numericas),</span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a>                          <span class="at">segundacarga=</span><span class="fu">data.frame</span>(pca<span class="sc">$</span>rotation)[,<span class="dv">2</span>]))</span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(carga1,carga2)</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=TRUE}</span></span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(carga1, <span class="fu">aes</span>(<span class="fu">colnames</span>(df_numericas) ,primeracarga)) <span class="sc">+</span> </span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_bar</span> (<span class="at">stat=</span><span class="st">"identity"</span> , </span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a>       <span class="at">position=</span><span class="st">"dodge"</span> ,</span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span><span class="st">"royalblue"</span> ,</span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span><span class="fl">0.5</span> ) <span class="sc">+</span> <span class="fu">xlab</span>( <span class="st">'Variables'</span> ) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Primera carga'</span> )</span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a><span class="fu">## Autovalores</span></span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a>¬øQu√© proporci√≥n de la variabilidad total es explicada por las componentes?</span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="co"># autovalores</span></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a>prop_varianza <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a>prop_varianza</span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(prop_varianza, <span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pc, <span class="at">y =</span> prop_varianza)) <span class="sc">+</span></span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Componente principal"</span>,</span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Prop. de varianza explicada"</span>)</span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Biplot</span></span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Los objetos son ordenados en funci√≥n de su puntaje en cada uno de los componentes analizados</span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Las variables son representadas como vectores</span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(<span class="at">x =</span> pca, <span class="at">scale =</span> <span class="dv">0</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue4"</span>, <span class="st">"brown3"</span>))</span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a>Mejoremos la visualizaci√≥n</span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Poblacion'</span>,</span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">5</span>)</span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a>Vizualicemos las primeras 3 componentes:</span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">&lt;-</span> pca[[<span class="st">"x"</span>]]</span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(componentes)</span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>componentes <span class="ot">=</span> <span class="fu">cbind</span>(componentes, df<span class="sc">$</span>Poblacion)</span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a>titulo <span class="ot">=</span> <span class="st">'Primeras 3 CPs'</span></span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(componentes, </span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="sc">~</span>PC1, </span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="sc">~</span>PC2, </span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a>               <span class="at">z =</span> <span class="sc">~</span>PC3, </span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="sc">~</span>df<span class="sc">$</span>Poblacion,</span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>               <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">'#636EFA'</span>,<span class="st">'#EF553B'</span>,<span class="st">'#00CC96'</span>) ) <span class="sc">|&gt;</span> </span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_markers</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">|&gt;</span> </span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> titulo,</span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">bgcolor =</span> <span class="st">"#f3f2fc"</span>)</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>¬øC√≥mo interpretamos el biplot?</span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a>¬øCon cu√°ntas componentes nos quedamos? Lo vemos la pr√≥xima clase.</span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>