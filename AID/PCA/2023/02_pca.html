<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pamela E. Pairo- AID 2023">
<meta name="description" content="Biplot y tÃ©cnicas robustas">

<title>PCA-Parte 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="02_pca_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_pca_files/libs/quarto-html/quarto.js"></script>
<script src="02_pca_files/libs/quarto-html/popper.min.js"></script>
<script src="02_pca_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02_pca_files/libs/quarto-html/anchor.min.js"></script>
<link href="02_pca_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_pca_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02_pca_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02_pca_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02_pca_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="02_pca_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="02_pca_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#base-de-datos-sobre-la-venta-de-sillas-de-autos-para-chiques" id="toc-base-de-datos-sobre-la-venta-de-sillas-de-autos-para-chiques" class="nav-link active" data-scroll-target="#base-de-datos-sobre-la-venta-de-sillas-de-autos-para-chiques">Base de datos sobre la venta de sillas de autos para chiques</a>
  <ul class="collapse">
  <li><a href="#boxplots-para-todas-las-variables" id="toc-boxplots-para-todas-las-variables" class="nav-link" data-scroll-target="#boxplots-para-todas-las-variables">Boxplots para todas las variables</a></li>
  </ul></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a>
  <ul class="collapse">
  <li><a href="#cargas-o-loadings" id="toc-cargas-o-loadings" class="nav-link" data-scroll-target="#cargas-o-loadings">Cargas o <em>loadings</em></a></li>
  <li><a href="#autovalores" id="toc-autovalores" class="nav-link" data-scroll-target="#autovalores">Autovalores</a></li>
  </ul></li>
  <li><a href="#cuÃ¡ntas-cps-elegir" id="toc-cuÃ¡ntas-cps-elegir" class="nav-link" data-scroll-target="#cuÃ¡ntas-cps-elegir">Â¿CuÃ¡ntas CPs elegir?</a>
  <ul class="collapse">
  <li><a href="#criterio-1-porcentaje-de-variabilidad-explicada" id="toc-criterio-1-porcentaje-de-variabilidad-explicada" class="nav-link" data-scroll-target="#criterio-1-porcentaje-de-variabilidad-explicada">Criterio 1: Porcentaje de variabilidad explicada</a></li>
  <li><a href="#criterio-2-criterio-de-kaiser" id="toc-criterio-2-criterio-de-kaiser" class="nav-link" data-scroll-target="#criterio-2-criterio-de-kaiser">Criterio 2: Criterio de Kaiser</a></li>
  <li><a href="#criterio-3-criterio-del-bastÃ³n-roto" id="toc-criterio-3-criterio-del-bastÃ³n-roto" class="nav-link" data-scroll-target="#criterio-3-criterio-del-bastÃ³n-roto">Criterio 3: Criterio del bastÃ³n roto</a></li>
  </ul></li>
  <li><a href="#biplot" id="toc-biplot" class="nav-link" data-scroll-target="#biplot">Biplot</a>
  <ul class="collapse">
  <li><a href="#scores" id="toc-scores" class="nav-link" data-scroll-target="#scores"><em>Scores</em></a></li>
  <li><a href="#quÃ©-informaciÃ³n-podemos-sacar-del-biplot" id="toc-quÃ©-informaciÃ³n-podemos-sacar-del-biplot" class="nav-link" data-scroll-target="#quÃ©-informaciÃ³n-podemos-sacar-del-biplot">Â¿QuÃ© informaciÃ³n podemos sacar del biplot? ðŸ¤”</a></li>
  <li><a href="#y-si-se-quiere-graficar-el-pc2-vs-pc3" id="toc-y-si-se-quiere-graficar-el-pc2-vs-pc3" class="nav-link" data-scroll-target="#y-si-se-quiere-graficar-el-pc2-vs-pc3">Â¿Y si se quiere graficar el PC2 vs PC3?</a>
  <ul class="collapse">
  <li><a href="#en-python" id="toc-en-python" class="nav-link" data-scroll-target="#en-python">En Python</a></li>
  </ul></li>
  <li><a href="#pca-robusto" id="toc-pca-robusto" class="nav-link" data-scroll-target="#pca-robusto">PCA robusto</a>
  <ul class="collapse">
  <li><a href="#mÃ­nimo-determinante-de-la-covariancia-mcd" id="toc-mÃ­nimo-determinante-de-la-covariancia-mcd" class="nav-link" data-scroll-target="#mÃ­nimo-determinante-de-la-covariancia-mcd">MÃ­nimo Determinante de la Covariancia (MCD)</a></li>
  <li><a href="#elipsoide-de-volumen-mÃ­nimo-mve" id="toc-elipsoide-de-volumen-mÃ­nimo-mve" class="nav-link" data-scroll-target="#elipsoide-de-volumen-mÃ­nimo-mve">2- Elipsoide de volumen mÃ­nimo (MVE)</a></li>
  </ul></li>
  <li><a href="#comparando-la-varianza-explicada-entre-pca-no-robusto-y-mve" id="toc-comparando-la-varianza-explicada-entre-pca-no-robusto-y-mve" class="nav-link" data-scroll-target="#comparando-la-varianza-explicada-entre-pca-no-robusto-y-mve">Comparando la varianza explicada entre PCA no robusto y MVE</a></li>
  <li><a href="#scree-plot-del-pca-no-robusto" id="toc-scree-plot-del-pca-no-robusto" class="nav-link" data-scroll-target="#scree-plot-del-pca-no-robusto">Scree plot del PCA NO robusto</a></li>
  <li><a href="#scree-plot-del-pca-mcd" id="toc-scree-plot-del-pca-mcd" class="nav-link" data-scroll-target="#scree-plot-del-pca-mcd">Scree plot del PCA MCD</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">PCA-Parte 2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> CÃ³digo</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el cÃ³digo</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el cÃ³digo</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el cÃ³digo fuente</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    <p>Biplot y tÃ©cnicas robustas</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Pamela E. Pairo- AID 2023 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="base-de-datos-sobre-la-venta-de-sillas-de-autos-para-chiques" class="level1">
<h1>Base de datos sobre la venta de sillas de autos para chiques</h1>
<p>Un conjunto de datos simulados que contiene las ventas de sillas de coche en 400 locales diferentes.</p>
<p><code>Sales</code>: Unit sales (in thousands) at each location</p>
<p><code>CompPrice</code>: Price charged by competitor at each location</p>
<p><code>Income</code>: Community income level (in thousands of dollars)</p>
<p><code>Advertising</code>: Local advertising budget for company at each location (in thousands of dollars)</p>
<p><code>Population</code>: Population size in region (in thousands)</p>
<p><code>Price</code>: Price company charges for car seats at each site</p>
<p><code>ShelveLoc</code>: A factor with levels Bad, Good and Medium indicating the quality of the shelving location for the car seats at each site</p>
<p><code>Age</code>: Average age of the local population</p>
<p><code>Education</code>: Education level at each location</p>
<p><code>Urban</code>: A factor with levels No and Yes to indicate whether the store is in an urban or rural location</p>
<p><code>US</code>: A factor with levels No and Yes to indicate whether the store is in the US or not</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Carseats"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Carseats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 400
Columns: 11
$ Sales       &lt;dbl&gt; 9.50, 11.22, 10.06, 7.40, 4.15, 10.81, 6.63, 11.85, 6.54, ~
$ CompPrice   &lt;dbl&gt; 138, 111, 113, 117, 141, 124, 115, 136, 132, 132, 121, 117~
$ Income      &lt;dbl&gt; 73, 48, 35, 100, 64, 113, 105, 81, 110, 113, 78, 94, 35, 2~
$ Advertising &lt;dbl&gt; 11, 16, 10, 4, 3, 13, 0, 15, 0, 0, 9, 4, 2, 11, 11, 5, 0, ~
$ Population  &lt;dbl&gt; 276, 260, 269, 466, 340, 501, 45, 425, 108, 131, 150, 503,~
$ Price       &lt;dbl&gt; 120, 83, 80, 97, 128, 72, 108, 120, 124, 124, 100, 94, 136~
$ ShelveLoc   &lt;fct&gt; Bad, Good, Medium, Medium, Bad, Bad, Medium, Good, Medium,~
$ Age         &lt;dbl&gt; 42, 65, 59, 55, 38, 78, 71, 67, 76, 76, 26, 50, 62, 53, 52~
$ Education   &lt;dbl&gt; 17, 10, 12, 14, 13, 16, 15, 10, 10, 17, 10, 13, 18, 18, 18~
$ Urban       &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, No, Yes, Yes, No, No, No, Yes, Ye~
$ US          &lt;fct&gt; Yes, Yes, Yes, Yes, No, Yes, No, Yes, No, Yes, Yes, Yes, N~</code></pre>
</div>
</div>
<p>Nos quedamos con las variables numÃ©ricas</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>numericas <span class="ot">&lt;-</span> <span class="fu">select_if</span>(df, is.numeric)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>numericas<span class="sc">$</span>Sales <span class="ot">&lt;-</span><span class="cn">NULL</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="boxplots-para-todas-las-variables" class="level2">
<h2 class="anchored" data-anchor-id="boxplots-para-todas-las-variables">Boxplots para todas las variables</h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(numericas)  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz de correlaciÃ³n</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(numericas) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># representa la matriz de correlaciones mediante cÃ­rculos</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(m_cor,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"circle"</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">'upper'</span>, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="pca" class="level1">
<h1>PCA</h1>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(numericas,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pca)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sdev"     "rotation" "center"   "scale"    "x"       </code></pre>
</div>
</div>
<p><code>center</code>:contienen la media de las variables previa estandarizaciÃ³n (en la escala original)</p>
<p><code>scale</code>: contienen desviaciÃ³n tÃ­pica de las variables previa estandarizaciÃ³n (en la escala original)</p>
<p><code>rotation</code>: contiene los <em>loadings</em></p>
<section id="cargas-o-loadings" class="level2">
<h2 class="anchored" data-anchor-id="cargas-o-loadings">Cargas o <em>loadings</em></h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">PC1</th>
<th style="text-align: right;">PC2</th>
<th style="text-align: right;">PC3</th>
<th style="text-align: right;">PC4</th>
<th style="text-align: right;">PC5</th>
<th style="text-align: right;">PC6</th>
<th style="text-align: right;">PC7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CompPrice</td>
<td style="text-align: right;">-0.68</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">Income</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">0.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Advertising</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Population</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: right;">-0.67</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>contrib <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(contrib,<span class="at">is.corr=</span><span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(pca<span class="sc">$</span>center,<span class="dv">2</span>)) <span class="co">#vector de medias</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CompPrice</td>
<td style="text-align: right;">124.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">Income</td>
<td style="text-align: right;">68.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Advertising</td>
<td style="text-align: right;">6.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Population</td>
<td style="text-align: right;">264.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Price</td>
<td style="text-align: right;">115.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">53.32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: right;">13.90</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="autovalores" class="level2">
<h2 class="anchored" data-anchor-id="autovalores">Autovalores</h2>
<p>Â¿QuÃ© proporciÃ³n de la variabilidad total es explicada por cada una de las componentes?</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>prop_varianza <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>prop_varianza_acum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prop_varianza)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>prop_varianza_acum</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2346162 0.4219128 0.5672209 0.7050306 0.8415859 0.9417311 1.0000000</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(prop_varianza_acum, <span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pc, <span class="at">y =</span> prop_varianza_acum, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Componente principal"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Prop. varianza explicada acumulada"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="cuÃ¡ntas-cps-elegir" class="level1">
<h1>Â¿CuÃ¡ntas CPs elegir?</h1>
<section id="criterio-1-porcentaje-de-variabilidad-explicada" class="level2">
<h2 class="anchored" data-anchor-id="criterio-1-porcentaje-de-variabilidad-explicada">Criterio 1: Porcentaje de variabilidad explicada</h2>
<p>Se define un porcentaje de variabilidad mÃ­nimo que se desea explicar y se toman las primeras <em>m</em> componentes que alcanzan este porcentaje de explicaciÃ³n.</p>
<p>Por ejemplo se elige un porcentaje de 80% de variabilidad.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(prop_varianza_acum<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)<span class="co"># llevo datos a porcentaje</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  23.46  42.19  56.72  70.50  84.16  94.17 100.00</code></pre>
</div>
</div>
</section>
<section id="criterio-2-criterio-de-kaiser" class="level2">
<h2 class="anchored" data-anchor-id="criterio-2-criterio-de-kaiser">Criterio 2: Criterio de Kaiser</h2>
<p>Consiste en retener las <em>m</em> primeras componentes tales que sus autovalores resulten iguales o mayores que 1.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">12</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="criterio-3-criterio-del-bastÃ³n-roto" class="level2">
<h2 class="anchored" data-anchor-id="criterio-3-criterio-del-bastÃ³n-roto">Criterio 3: Criterio del bastÃ³n roto</h2>
<p>Si la proporciÃ³n de variabilidad explicada por <span class="math inline">\(Y1, Y2, Â· Â· Â·, Ym\)</span> se estabiliza a partir de un cierto valor de CP, entonces aumentar la dimensiÃ³n no aportarÃ­a cambios significativos.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">""</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="biplot" class="level1">
<h1>Biplot</h1>
<ul>
<li><p>Los n objetos son ordenados en funciÃ³n de su puntaje en cada uno de los componentes analizados</p></li>
<li><p>Las p variables son representadas como vectores</p></li>
</ul>
<section id="scores" class="level2">
<h2 class="anchored" data-anchor-id="scores"><em>Scores</em></h2>
<p>Se estandarizan las variables originales y luego con la fÃ³rmula de la combinaciÃ³n lineal correspondiente para cada CP, se calculan los <em>scores</em> o puntajes de los vinos.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x[,<span class="dv">1</span>]<span class="co"># scores para la primer componente (PC1)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] -0.860922431  1.756253090  1.511832979  1.232599489 -1.208030843
  [6]  2.024853985  0.804933502 -0.054575498 -0.114105332 -0.277036653
 [11]  0.359784953  1.283593330 -0.550613517  0.763723133  0.797014309
 [16] -1.446841066  0.386767970 -1.248791429  2.136429791 -0.149628227
 [21] -0.602324022 -0.417989456 -0.797549990  0.567926527 -0.527691496
 [26]  0.090368251  0.904147290  1.493126983  1.673915849  1.485929043
 [31]  0.768093284 -1.160818161  0.261249062 -0.029788257 -0.134004025
 [36] -0.007906054  0.538211872  0.427523757  1.355433736 -1.133555850
 [41]  0.025329199 -1.670476459  4.301541844 -0.662641285  2.690713160
 [46] -1.483122152  1.053428404  0.163401950  0.912882975 -2.821991147
 [51]  1.601041914  0.570757219 -2.234150740  0.449337557 -0.980411731
 [56] -2.027218988  0.244305337  1.597300541  1.663435132  0.607732050
 [61]  0.109026508  0.654924334 -1.187414878  0.850626202  1.077781803
 [66] -0.508167696  0.818553634 -0.248442672 -1.280534155  0.545985957
 [71]  2.491331148 -2.148258714  0.023592606  0.401906425 -1.664546517
 [76]  2.586039123  2.611971761  0.975536020 -1.292117078  0.157324638
 [81]  2.155282307  0.232154679 -2.103716732  1.446311472 -0.247969558
 [86]  0.249893146 -1.274718870 -0.607073885  0.459097552 -0.227442580
 [91]  0.916576137  1.704529585  0.023006972 -1.063190903  1.469416799
 [96] -1.450353583 -1.245257017 -2.207798902 -0.178249732  0.212625158
[101]  1.028241546 -0.627900562  0.658394870  0.997847549 -0.140136365
[106]  1.941037069  0.171807889 -0.028419217  1.465777082  1.052843332
[111] -0.429696253 -1.119902989  0.484947168 -0.903713428  0.476957604
[116] -1.496219002 -0.417904377 -1.000631036  1.292559666 -0.345480188
[121] -0.199741281  0.845180485  0.829866628 -1.516099055 -0.151585645
[126]  3.249437434 -1.941795094 -0.243593702 -0.378713894 -1.440406966
[131]  2.835003175  1.528225440 -0.137930872  0.504617302 -0.718914624
[136]  1.137928062 -1.023588327  0.174862784  0.507903966 -0.556791233
[141] -0.960848186 -1.580337021  0.704098811 -1.584080923 -0.727797899
[146] -1.257146364  0.037808352 -0.912349158  1.756290285  1.321552014
[151]  0.355039450  1.310257961 -0.487785479 -2.495426160 -0.068343680
[156]  2.389489554 -2.464558223  0.801230958 -0.711094985  1.147004899
[161]  0.433139505 -2.259127169 -0.685895029 -0.489788962 -2.296228449
[166] -3.660376010 -0.260163475  1.525677124 -0.001952031  2.268703201
[171]  0.094343643  3.753102084  0.912360002 -0.691019737 -2.496824390
[176] -0.170196014 -1.233658922 -0.517274586  1.470278534 -1.113484186
[181] -0.837165487  1.003999576 -1.642175024  1.081922422 -0.013313773
[186]  0.636242139  0.582100901  0.572880955  1.297708430  0.837889132
[191] -0.080340414 -2.919722418  1.272636035 -0.021679501  0.650650513
[196]  0.953348281 -0.633372383 -0.391159785  0.798590397  0.130501937
[201] -1.383245228 -1.284833375 -0.040406114 -1.880074808 -1.786157886
[206] -0.435587477 -2.957440238  1.685530480  3.071431682  2.119486255
[211] -0.389636795  0.424568855 -0.302483687 -1.833108483  0.852270223
[216] -0.035613338 -2.100928439  1.191845119 -1.151630244  0.596795415
[221] -0.337604982  0.397120569 -1.323273984  0.410762779 -0.952514384
[226]  1.376214619 -0.140798770  0.760493562 -2.481590693  2.256271722
[231]  0.073799626 -0.906718822 -0.293594279 -0.252143329  0.063216259
[236] -0.972898515 -0.219862665 -1.657454437 -0.388722689  0.119092210
[241] -2.019515362 -0.187093428 -0.749380009  0.015351833 -0.384446035
[246]  1.180041474  1.171253848 -0.977787898  0.851243372 -0.025089862
[251] -1.063288188 -0.688077766 -0.785092567 -0.266904150  0.486242428
[256]  1.387326370 -1.614161697  0.671564887  1.735831700  0.900134902
[261]  0.527784509 -0.141917941 -0.468995556 -0.106445628 -1.837530093
[266] -0.898773233  0.371684692 -0.008611499  0.006004791 -3.002501506
[271]  0.526276210  0.926820014  1.416293743  1.546955371 -0.772268139
[276]  0.680767495 -0.547630126 -1.043405370 -0.614781245 -1.803164513
[281] -0.238114183  0.311595370 -2.076995015 -0.168199389  1.675272023
[286] -1.634277005  0.935093712  2.158353405  0.803741901 -1.805002593
[291]  1.496545969  0.614652986  2.068514156  0.888868557 -0.496172509
[296]  0.226593908 -0.469453728  1.160112494 -1.374679243  0.160008378
[301]  0.765218117  1.976394240  1.376261776  0.072566069 -0.288719212
[306] -0.195603331 -1.167463771 -0.694901873  0.069052079  0.879210628
[311] -3.304569791 -1.330873654 -0.840049736  3.143748129 -0.620543000
[316] -2.419062851  1.151780728 -1.102918362  0.056434159 -0.196814088
[321] -1.779537964  0.351476719 -1.315869210  1.403194658 -1.589874822
[326] -0.594344185 -0.985780315  1.138287240  0.358860663  1.904367579
[331]  0.078300786 -1.127122711  1.312004819 -1.422573582  2.712634326
[336]  0.833366152 -2.149091825  0.264686883  0.589946982 -1.031802661
[341] -0.566897045  2.419382481  0.103933038 -0.160505402 -0.761459577
[346] -0.425982464 -0.747584228  0.761376996  0.419665841  0.137783647
[351]  1.608265250  0.891028088 -0.261245142  1.474769425 -1.850435115
[356] -0.975357530 -1.795905563  1.946165081  0.305866112 -0.355650850
[361]  0.410617011 -0.219415303 -0.067896669  0.634960715 -0.580257322
[366] -3.024250047 -0.293551839  3.144228183  1.846986541 -0.376242210
[371] -0.134812079 -1.589918155  0.970873592 -0.237339864 -0.625655598
[376] -0.411912291  0.018391935 -0.764636081 -0.137523708  0.528566114
[381]  1.473164085 -0.334223772  0.101180259  2.824684546 -0.101913247
[386] -0.464324057 -2.562449832 -0.437622784  1.005026183 -0.139647518
[391]  0.986077497 -1.777682774 -0.847109063 -0.069916840 -1.065348329
[396] -0.941465461 -1.118125672 -3.248365331  1.786355059 -1.068156805</code></pre>
</div>
</div>
<p><em>Scores</em> para todas las CPs.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res.ind <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(res.ind<span class="sc">$</span>coord,<span class="dv">10</span>), <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; "><table class="table" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> Dim.1 </th>
   <th style="text-align:right;"> Dim.2 </th>
   <th style="text-align:right;"> Dim.3 </th>
   <th style="text-align:right;"> Dim.4 </th>
   <th style="text-align:right;"> Dim.5 </th>
   <th style="text-align:right;"> Dim.6 </th>
   <th style="text-align:right;"> Dim.7 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> -0.8609224 </td>
   <td style="text-align:right;"> 0.2956968 </td>
   <td style="text-align:right;"> 0.4238498 </td>
   <td style="text-align:right;"> -0.7066462 </td>
   <td style="text-align:right;"> -1.1447556 </td>
   <td style="text-align:right;"> 0.1298289 </td>
   <td style="text-align:right;"> 0.5162957 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1.7562531 </td>
   <td style="text-align:right;"> 0.8792255 </td>
   <td style="text-align:right;"> 0.3693384 </td>
   <td style="text-align:right;"> 0.7718860 </td>
   <td style="text-align:right;"> 1.0591391 </td>
   <td style="text-align:right;"> 1.4740716 </td>
   <td style="text-align:right;"> 0.3579915 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1.5118330 </td>
   <td style="text-align:right;"> 0.0958802 </td>
   <td style="text-align:right;"> 0.8361156 </td>
   <td style="text-align:right;"> 0.0672019 </td>
   <td style="text-align:right;"> 1.1242515 </td>
   <td style="text-align:right;"> 0.8610406 </td>
   <td style="text-align:right;"> 0.4933420 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1.2325995 </td>
   <td style="text-align:right;"> 0.6126380 </td>
   <td style="text-align:right;"> -0.4863724 </td>
   <td style="text-align:right;"> -0.1523573 </td>
   <td style="text-align:right;"> -0.3494722 </td>
   <td style="text-align:right;"> -1.3468562 </td>
   <td style="text-align:right;"> 0.3107267 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> -1.2080308 </td>
   <td style="text-align:right;"> 0.3462485 </td>
   <td style="text-align:right;"> -0.3428633 </td>
   <td style="text-align:right;"> -0.6478458 </td>
   <td style="text-align:right;"> 0.6058365 </td>
   <td style="text-align:right;"> -0.5680669 </td>
   <td style="text-align:right;"> 0.3881327 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.0248540 </td>
   <td style="text-align:right;"> 1.0673539 </td>
   <td style="text-align:right;"> 0.2616404 </td>
   <td style="text-align:right;"> 1.0369430 </td>
   <td style="text-align:right;"> -1.6747578 </td>
   <td style="text-align:right;"> -1.0134409 </td>
   <td style="text-align:right;"> 1.4722249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.8049335 </td>
   <td style="text-align:right;"> -1.8354777 </td>
   <td style="text-align:right;"> -1.0444605 </td>
   <td style="text-align:right;"> 0.8648973 </td>
   <td style="text-align:right;"> -0.9058813 </td>
   <td style="text-align:right;"> -0.0677651 </td>
   <td style="text-align:right;"> -0.3524650 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> -0.0545755 </td>
   <td style="text-align:right;"> 1.9406418 </td>
   <td style="text-align:right;"> -0.3847400 </td>
   <td style="text-align:right;"> 1.4316937 </td>
   <td style="text-align:right;"> 0.4092503 </td>
   <td style="text-align:right;"> 0.0896470 </td>
   <td style="text-align:right;"> 0.5398256 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> -0.1141053 </td>
   <td style="text-align:right;"> -0.8504005 </td>
   <td style="text-align:right;"> -2.0505746 </td>
   <td style="text-align:right;"> 1.9308344 </td>
   <td style="text-align:right;"> 0.3338578 </td>
   <td style="text-align:right;"> -0.1841578 </td>
   <td style="text-align:right;"> -0.0030234 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> -0.2770367 </td>
   <td style="text-align:right;"> -1.5642691 </td>
   <td style="text-align:right;"> -0.7340550 </td>
   <td style="text-align:right;"> 1.2216681 </td>
   <td style="text-align:right;"> -1.6531902 </td>
   <td style="text-align:right;"> -0.8549827 </td>
   <td style="text-align:right;"> 0.0211949 </td>
  </tr>
</tbody>
</table></div>

</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> F, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">label.size =</span> <span class="dv">3</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="dv">0</span>, <span class="co"># scale=0 biplot segun scores</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label=</span>T,<span class="co"># nombre de las variables</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings=</span>T)<span class="co"># variables como vectores</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y si se diferencia a cada punto segÃºn la variedad de vino?</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Sales'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="quÃ©-informaciÃ³n-podemos-sacar-del-biplot" class="level2">
<h2 class="anchored" data-anchor-id="quÃ©-informaciÃ³n-podemos-sacar-del-biplot">Â¿QuÃ© informaciÃ³n podemos sacar del biplot? ðŸ¤”</h2>
<p>Tener en cuenta lo siguiente:</p>
<ul>
<li><p>Si se es el/la experto/a de dominio (o se le puede consultar) se puede dar una interpretaciÃ³n a quÃ© aspecto del tema se refiere PC1 y PC2, considerando los <em>loadings</em> de las varibles originales.</p></li>
<li><p>Si dos variables forman Ã¡ngulos pequeÃ±os; esto nos estarÃ­a diciendo que las variables estÃ¡n muy correlacionadas (en este ejemplo serÃ­a el caso de <code>Price</code> y <code>CompPrice</code>)</p></li>
<li><p>Si dos variables forman Ã¡ngulos de 90Â°, entonces nos indica que ambas variables <strong>no</strong> estÃ¡n correlacionadas (por ejemplo <code>Price</code> y <code>Population</code>).</p></li>
<li><p>Los resultados del PCA son sensibles a la presencia de <em>outliers</em> por lo que pueden distorsionar el ordenamiento.</p></li>
</ul>
</section>
<section id="y-si-se-quiere-graficar-el-pc2-vs-pc3" class="level2">
<h2 class="anchored" data-anchor-id="y-si-se-quiere-graficar-el-pc2-vs-pc3">Â¿Y si se quiere graficar el PC2 vs PC3?</h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Sales'</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="en-python" class="level3">
<h3 class="anchored" data-anchor-id="en-python">En Python</h3>
<p>En <a href="https://github.com/PamelaPairo/maestria_DM/blob/main/AID/PCA/02_PCA%20en%20Python.ipynb">este link</a> se puede ver el cÃ³digo en Python para realizar PCA.</p>
</section>
</section>
<section id="pca-robusto" class="level2">
<h2 class="anchored" data-anchor-id="pca-robusto">PCA robusto</h2>
<p><strong>TÃ©cnicas robustas</strong></p>
<p>Una de las alternativas robustas propuestas es <em>Minimun Covariance Determinant</em> (MCD), y otra es el <em>Minimum volume ellipsoid</em> (MVE).</p>
<p>Para mas detalle de cada tÃ©cnica mirar los papers correspondientes:</p>
<p>1- Link de descarga <a href="https://www.researchgate.net/publication/354058635_Robust_Principal_Component_Analysis_Using_Minimum_Covariance_Determinant_Estimator">aqui</a> para MCD</p>
<p>2- Link de descarga <a href="https://www.researchgate.net/publication/229803108_Minimum_Volume_Ellipsoid/link/59e1d3560f7e9b97fbe72fa9/download">aquÃ­</a> para MVE.</p>
<p>Se agregan <em>outliers</em> a la base de datos</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_out<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">as_tibble</span>(Carseats), </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">900</span>, <span class="dv">3</span>, <span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">3</span>, <span class="st">"Good"</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="st">"No"</span>, <span class="st">"No"</span>) ,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> (<span class="dv">5</span>, <span class="dv">250</span>, <span class="dv">3000</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">150</span>, <span class="st">"Good"</span>, <span class="dv">70</span>, <span class="dv">10</span>, <span class="st">"Yes"</span>, <span class="st">"Si"</span>) ,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> ( <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">20</span>, <span class="dv">100</span>, <span class="st">"Medium"</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="st">"No"</span>, <span class="st">"No"</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df_out)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 403
Columns: 11
$ Sales       &lt;chr&gt; "9.5", "11.22", "10.06", "7.4", "4.15", "10.81", "6.63", "~
$ CompPrice   &lt;chr&gt; "138", "111", "113", "117", "141", "124", "115", "136", "1~
$ Income      &lt;chr&gt; "73", "48", "35", "100", "64", "113", "105", "81", "110", ~
$ Advertising &lt;chr&gt; "11", "16", "10", "4", "3", "13", "0", "15", "0", "0", "9"~
$ Population  &lt;chr&gt; "276", "260", "269", "466", "340", "501", "45", "425", "10~
$ Price       &lt;chr&gt; "120", "83", "80", "97", "128", "72", "108", "120", "124",~
$ ShelveLoc   &lt;fct&gt; Bad, Good, Medium, Medium, Bad, Bad, Medium, Good, Medium,~
$ Age         &lt;chr&gt; "42", "65", "59", "55", "38", "78", "71", "67", "76", "76"~
$ Education   &lt;chr&gt; "17", "10", "12", "14", "13", "16", "15", "10", "10", "17"~
$ Urban       &lt;fct&gt; Yes, Yes, Yes, Yes, Yes, No, Yes, Yes, No, No, No, Yes, Ye~
$ US          &lt;fct&gt; Yes, Yes, Yes, Yes, No, Yes, No, Yes, No, Yes, Yes, Yes, N~</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_out <span class="ot">&lt;-</span>df_out <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate_if</span>(is.character, as.numeric)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>Sales <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>ShelveLoc <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>Urban <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>US <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="mÃ­nimo-determinante-de-la-covariancia-mcd" class="level3">
<h3 class="anchored" data-anchor-id="mÃ­nimo-determinante-de-la-covariancia-mcd">MÃ­nimo Determinante de la Covariancia (MCD)</h3>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pca_mcd <span class="ot">&lt;-</span><span class="fu">princomp</span>(df_out, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cor=</span><span class="cn">TRUE</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scores=</span><span class="cn">TRUE</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covmat=</span>MASS<span class="sc">::</span><span class="fu">cov.mcd</span>(df_out))<span class="co">#se especifica MCD</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_mcd)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3    Comp.4    Comp.5
Standard deviation     1.2890870 1.1343891 1.0234573 0.9955507 0.9408133
Proportion of Variance 0.2373922 0.1838341 0.1496378 0.1415887 0.1264471
Cumulative Proportion  0.2373922 0.4212263 0.5708641 0.7124528 0.8388999
                          Comp.6    Comp.7
Standard deviation     0.8472907 0.6401554
Proportion of Variance 0.1025574 0.0585427
Cumulative Proportion  0.9414573 1.0000000</code></pre>
</div>
</div>
</section>
<section id="elipsoide-de-volumen-mÃ­nimo-mve" class="level3">
<h3 class="anchored" data-anchor-id="elipsoide-de-volumen-mÃ­nimo-mve">2- Elipsoide de volumen mÃ­nimo (MVE)</h3>
<p>Esta estimaciÃ³n busca el elipsoide de volumen mÃ­nimo que contiene al menos la mitad de los puntos del conjunto de datos.</p>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pca_mve <span class="ot">&lt;-</span><span class="fu">princomp</span>(df_out, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cor=</span><span class="cn">TRUE</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scores=</span><span class="cn">TRUE</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covmat=</span>MASS<span class="sc">::</span><span class="fu">cov.mve</span>(df_out))<span class="co">#se especifica MVE</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_mve)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2    Comp.3    Comp.4    Comp.5
Standard deviation     1.3038625 1.1479764 1.0240071 0.9888447 0.9158508
Proportion of Variance 0.2428653 0.1882643 0.1497986 0.1396877 0.1198261
Cumulative Proportion  0.2428653 0.4311296 0.5809283 0.7206159 0.8404421
                           Comp.6     Comp.7
Standard deviation     0.82606372 0.65918462
Proportion of Variance 0.09748304 0.06207491
Cumulative Proportion  0.93792509 1.00000000</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span><span class="fu">fviz_eig</span>(pca_mve, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"MVE"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">fviz_eig</span>(pca_mcd, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"MCD"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_mve, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">7</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="comparando-la-varianza-explicada-entre-pca-no-robusto-y-mve" class="level2">
<h2 class="anchored" data-anchor-id="comparando-la-varianza-explicada-entre-pca-no-robusto-y-mve">Comparando la varianza explicada entre PCA no robusto y MVE</h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pca_out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df_out,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca_out, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df_out, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> F, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">label.size =</span> <span class="dv">3</span>, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="dv">0</span>, <span class="co"># scale=0 biplot segun scores</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label=</span>T,<span class="co"># nombre de las variables</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings=</span>T)<span class="co"># variables como vectores</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span><span class="fu">fviz_eig</span>(pca_out, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">ncp =</span><span class="dv">7</span>, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">addlabels =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">main=</span><span class="st">"No robusto"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">barfill =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">barcolor =</span> <span class="st">"#69b3a2"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p2,p3, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scree-plot-del-pca-no-robusto" class="level2">
<h2 class="anchored" data-anchor-id="scree-plot-del-pca-no-robusto">Scree plot del PCA NO robusto</h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_out, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">12</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scree-plot-del-pca-mcd" class="level2">
<h2 class="anchored" data-anchor-id="scree-plot-del-pca-mcd">Scree plot del PCA MCD</h2>
<div class="cell">
<details open="">
<summary>CÃ³digo</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_mcd, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">7</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="02_pca_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el cÃ³digo</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "PCA-Parte 2"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Pamela E. Pairo- AID 2023"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="an">lang:</span><span class="co"> es</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Biplot y tÃ©cnicas robustas</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:  flatly</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Base de datos sobre la venta de sillas de autos para chiques </span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>Un conjunto de datos simulados que contiene las ventas de sillas de coche en 400 locales diferentes.</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="in">`Sales`</span>: Unit sales (in thousands) at each location</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="in">`CompPrice`</span>: Price charged by competitor at each location</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="in">`Income`</span>: Community income level (in thousands of dollars)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="in">`Advertising`</span>: Local advertising budget for company at each location (in thousands of dollars)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="in">`Population`</span>: Population size in region (in thousands)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="in">`Price`</span>: Price company charges for car seats at each site</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="in">`ShelveLoc`</span>: A factor with levels Bad, Good and Medium indicating the quality of the shelving location for the car seats at each site</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="in">`Age`</span>: Average age of the local population</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="in">`Education`</span>: Education level at each location</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="in">`Urban`</span>: A factor with levels No and Yes to indicate whether the store is in an urban or rural location</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a><span class="in">`US`</span>: A factor with levels No and Yes to indicate whether the store is in the US or not</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Carseats"</span>)</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Carseats)</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>Nos quedamos con las variables numÃ©ricas</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>numericas <span class="ot">&lt;-</span> <span class="fu">select_if</span>(df, is.numeric)</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>numericas<span class="sc">$</span>Sales <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplots para todas las variables</span></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(numericas)  </span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scale=</span><span class="st">"free"</span>)</span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriz de correlaciÃ³n</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(numericas) </span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a><span class="co"># representa la matriz de correlaciones mediante cÃ­rculos</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(m_cor,</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"circle"</span>, </span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">'upper'</span>, </span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">diag =</span> <span class="cn">FALSE</span>) </span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a><span class="fu"># PCA</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(numericas,</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pca)</span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a><span class="in">`center`</span>:contienen la media de las variables previa estandarizaciÃ³n (en la escala original)</span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a><span class="in">`scale`</span>: contienen desviaciÃ³n tÃ­pica de las variables previa estandarizaciÃ³n (en la escala original)</span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a><span class="in">`rotation`</span>: contiene los *loadings*</span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cargas o _loadings_</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>))</span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>contrib <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">round</span>(pca<span class="sc">$</span>rotation,<span class="dv">2</span>))</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(contrib,<span class="at">is.corr=</span><span class="cn">FALSE</span>)</span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(pca<span class="sc">$</span>center,<span class="dv">2</span>)) <span class="co">#vector de medias</span></span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Autovalores</span></span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a>Â¿QuÃ© proporciÃ³n de la variabilidad total es explicada por cada una de las componentes?</span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a>prop_varianza <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a>prop_varianza_acum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prop_varianza)</span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a>prop_varianza_acum</span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(prop_varianza_acum, <span class="at">pc =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pc, <span class="at">y =</span> prop_varianza_acum, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb38-157"><a href="#cb38-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-158"><a href="#cb38-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Componente principal"</span>,</span>
<span id="cb38-159"><a href="#cb38-159" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Prop. varianza explicada acumulada"</span>)</span>
<span id="cb38-160"><a href="#cb38-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a><span class="fu"># Â¿CuÃ¡ntas CPs elegir?</span></span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Criterio 1: Porcentaje de variabilidad explicada</span></span>
<span id="cb38-165"><a href="#cb38-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-166"><a href="#cb38-166" aria-hidden="true" tabindex="-1"></a>Se define un porcentaje de variabilidad mÃ­nimo que se desea explicar y se toman las</span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a>primeras _m_ componentes que alcanzan este porcentaje de explicaciÃ³n.</span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a>Por ejemplo se elige un porcentaje de 80% de variabilidad.</span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-174"><a href="#cb38-174" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(prop_varianza_acum<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)<span class="co"># llevo datos a porcentaje</span></span>
<span id="cb38-175"><a href="#cb38-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Criterio 2: Criterio de Kaiser</span></span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a>Consiste en retener las _m_ primeras componentes tales que sus autovalores resulten iguales o mayores que 1.</span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-183"><a href="#cb38-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">12</span>)</span>
<span id="cb38-185"><a href="#cb38-185" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb38-186"><a href="#cb38-186" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-190"><a href="#cb38-190" aria-hidden="true" tabindex="-1"></a><span class="fu">## Criterio 3: Criterio del bastÃ³n roto</span></span>
<span id="cb38-191"><a href="#cb38-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a>Si la proporciÃ³n de variabilidad explicada por $Y1, Y2, Â· Â· Â·, Ym$ se estabiliza a partir de un cierto valor de CP, entonces aumentar la dimensiÃ³n no aportarÃ­a cambios significativos.</span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-200"><a href="#cb38-200" aria-hidden="true" tabindex="-1"></a><span class="fu"># Biplot</span></span>
<span id="cb38-201"><a href="#cb38-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Los n objetos son ordenados en funciÃ³n de su puntaje en cada uno de los componentes analizados</span>
<span id="cb38-203"><a href="#cb38-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-204"><a href="#cb38-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Las p variables son representadas como vectores</span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## _Scores_</span></span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a>Se estandarizan las variables originales y luego con la fÃ³rmula de la combinaciÃ³n lineal correspondiente para cada CP, se calculan los _scores_ o puntajes de los vinos.</span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-212"><a href="#cb38-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x[,<span class="dv">1</span>]<span class="co"># scores para la primer componente (PC1)</span></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a>_Scores_ para todas las CPs.</span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a>res.ind <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca)</span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(res.ind<span class="sc">$</span>coord,<span class="dv">10</span>), <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>)</span>
<span id="cb38-224"><a href="#cb38-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-225"><a href="#cb38-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-226"><a href="#cb38-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> F, </span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">label.size =</span> <span class="dv">3</span>, </span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="dv">0</span>, <span class="co"># scale=0 biplot segun scores</span></span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label=</span>T,<span class="co"># nombre de las variables</span></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings=</span>T)<span class="co"># variables como vectores</span></span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a>Y si se diferencia a cada punto segÃºn la variedad de vino?</span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, </span>
<span id="cb38-245"><a href="#cb38-245" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb38-246"><a href="#cb38-246" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Sales'</span>,</span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">3</span>)</span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Â¿QuÃ© informaciÃ³n podemos sacar del biplot? ðŸ¤”</span></span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a>Tener en cuenta lo siguiente:</span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si se es el/la experto/a de dominio (o se le puede consultar) se puede dar una interpretaciÃ³n a quÃ© aspecto del tema se refiere PC1 y PC2, considerando los _loadings_ de las varibles originales.</span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si dos variables forman Ã¡ngulos pequeÃ±os; esto nos estarÃ­a diciendo que las variables estÃ¡n muy correlacionadas (en este ejemplo serÃ­a el caso de <span class="in">`Price`</span> y <span class="in">`CompPrice`</span>)</span>
<span id="cb38-260"><a href="#cb38-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-261"><a href="#cb38-261" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si dos variables forman Ã¡ngulos de 90Â°, entonces nos indica que ambas variables **no** estÃ¡n correlacionadas (por ejemplo <span class="in">`Price`</span> y <span class="in">`Population`</span>).</span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Los resultados del PCA son sensibles a la presencia de _outliers_ por lo que pueden distorsionar el ordenamiento.</span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a><span class="fu">## Â¿Y si se quiere graficar el PC2 vs PC3?</span></span>
<span id="cb38-266"><a href="#cb38-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>,</span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df, </span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">'Sales'</span>,</span>
<span id="cb38-273"><a href="#cb38-273" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-274"><a href="#cb38-274" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">3</span>)</span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-278"><a href="#cb38-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-279"><a href="#cb38-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### En Python</span></span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a>En <span class="co">[</span><span class="ot">este link</span><span class="co">](https://github.com/PamelaPairo/maestria_DM/blob/main/AID/PCA/02_PCA%20en%20Python.ipynb)</span> se puede ver el cÃ³digo en Python para realizar PCA.</span>
<span id="cb38-282"><a href="#cb38-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-283"><a href="#cb38-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## PCA robusto</span></span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-285"><a href="#cb38-285" aria-hidden="true" tabindex="-1"></a>**TÃ©cnicas robustas**</span>
<span id="cb38-286"><a href="#cb38-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-287"><a href="#cb38-287" aria-hidden="true" tabindex="-1"></a>Una de las alternativas robustas propuestas es *Minimun Covariance Determinant* (MCD), y otra es el *Minimum volume ellipsoid* (MVE).</span>
<span id="cb38-288"><a href="#cb38-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-289"><a href="#cb38-289" aria-hidden="true" tabindex="-1"></a>Para mas detalle de cada tÃ©cnica mirar los papers correspondientes:</span>
<span id="cb38-290"><a href="#cb38-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-291"><a href="#cb38-291" aria-hidden="true" tabindex="-1"></a>1- Link de descarga <span class="co">[</span><span class="ot">aqui</span><span class="co">](https://www.researchgate.net/publication/354058635_Robust_Principal_Component_Analysis_Using_Minimum_Covariance_Determinant_Estimator)</span> para MCD</span>
<span id="cb38-292"><a href="#cb38-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-293"><a href="#cb38-293" aria-hidden="true" tabindex="-1"></a>2- Link de descarga <span class="co">[</span><span class="ot">aquÃ­</span><span class="co">](https://www.researchgate.net/publication/229803108_Minimum_Volume_Ellipsoid/link/59e1d3560f7e9b97fbe72fa9/download)</span> para MVE.</span>
<span id="cb38-294"><a href="#cb38-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-295"><a href="#cb38-295" aria-hidden="true" tabindex="-1"></a>Se agregan *outliers* a la base de datos</span>
<span id="cb38-296"><a href="#cb38-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-299"><a href="#cb38-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-300"><a href="#cb38-300" aria-hidden="true" tabindex="-1"></a>df_out<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">as_tibble</span>(Carseats), </span>
<span id="cb38-301"><a href="#cb38-301" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> (<span class="dv">1</span>, <span class="dv">900</span>, <span class="dv">3</span>, <span class="dv">100</span>, <span class="dv">20</span>, <span class="dv">3</span>, <span class="st">"Good"</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="st">"No"</span>, <span class="st">"No"</span>) ,</span>
<span id="cb38-302"><a href="#cb38-302" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> (<span class="dv">5</span>, <span class="dv">250</span>, <span class="dv">3000</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">150</span>, <span class="st">"Good"</span>, <span class="dv">70</span>, <span class="dv">10</span>, <span class="st">"Yes"</span>, <span class="st">"Si"</span>) ,</span>
<span id="cb38-303"><a href="#cb38-303" aria-hidden="true" tabindex="-1"></a>              <span class="fu">c</span> ( <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">20</span>, <span class="dv">100</span>, <span class="st">"Medium"</span>, <span class="dv">20</span>, <span class="dv">20</span>, <span class="st">"No"</span>, <span class="st">"No"</span>))</span>
<span id="cb38-304"><a href="#cb38-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-305"><a href="#cb38-305" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df_out)</span>
<span id="cb38-306"><a href="#cb38-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-307"><a href="#cb38-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-310"><a href="#cb38-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-311"><a href="#cb38-311" aria-hidden="true" tabindex="-1"></a>df_out <span class="ot">&lt;-</span>df_out <span class="sc">|&gt;</span> </span>
<span id="cb38-312"><a href="#cb38-312" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate_if</span>(is.character, as.numeric)</span>
<span id="cb38-313"><a href="#cb38-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-314"><a href="#cb38-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-317"><a href="#cb38-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-318"><a href="#cb38-318" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>Sales <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-319"><a href="#cb38-319" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>ShelveLoc <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb38-320"><a href="#cb38-320" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>Urban <span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb38-321"><a href="#cb38-321" aria-hidden="true" tabindex="-1"></a>df_out<span class="sc">$</span>US <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-322"><a href="#cb38-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-323"><a href="#cb38-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-324"><a href="#cb38-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### MÃ­nimo Determinante de la Covariancia (MCD)</span></span>
<span id="cb38-325"><a href="#cb38-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-328"><a href="#cb38-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-329"><a href="#cb38-329" aria-hidden="true" tabindex="-1"></a>pca_mcd <span class="ot">&lt;-</span><span class="fu">princomp</span>(df_out, </span>
<span id="cb38-330"><a href="#cb38-330" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cor=</span><span class="cn">TRUE</span>,</span>
<span id="cb38-331"><a href="#cb38-331" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scores=</span><span class="cn">TRUE</span>,</span>
<span id="cb38-332"><a href="#cb38-332" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covmat=</span>MASS<span class="sc">::</span><span class="fu">cov.mcd</span>(df_out))<span class="co">#se especifica MCD</span></span>
<span id="cb38-333"><a href="#cb38-333" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_mcd)</span>
<span id="cb38-334"><a href="#cb38-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-335"><a href="#cb38-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-336"><a href="#cb38-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2- Elipsoide de volumen mÃ­nimo (MVE)</span></span>
<span id="cb38-337"><a href="#cb38-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-338"><a href="#cb38-338" aria-hidden="true" tabindex="-1"></a>Esta estimaciÃ³n busca el elipsoide de volumen mÃ­nimo que contiene al menos la mitad de los puntos del conjunto de datos.</span>
<span id="cb38-339"><a href="#cb38-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-342"><a href="#cb38-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-343"><a href="#cb38-343" aria-hidden="true" tabindex="-1"></a>pca_mve <span class="ot">&lt;-</span><span class="fu">princomp</span>(df_out, </span>
<span id="cb38-344"><a href="#cb38-344" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cor=</span><span class="cn">TRUE</span>, </span>
<span id="cb38-345"><a href="#cb38-345" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scores=</span><span class="cn">TRUE</span>,</span>
<span id="cb38-346"><a href="#cb38-346" aria-hidden="true" tabindex="-1"></a>                   <span class="at">covmat=</span>MASS<span class="sc">::</span><span class="fu">cov.mve</span>(df_out))<span class="co">#se especifica MVE</span></span>
<span id="cb38-347"><a href="#cb38-347" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_mve)</span>
<span id="cb38-348"><a href="#cb38-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-349"><a href="#cb38-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-352"><a href="#cb38-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-353"><a href="#cb38-353" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb38-354"><a href="#cb38-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-355"><a href="#cb38-355" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb38-356"><a href="#cb38-356" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span><span class="fu">fviz_eig</span>(pca_mve, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"MVE"</span>)</span>
<span id="cb38-357"><a href="#cb38-357" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span> <span class="fu">fviz_eig</span>(pca_mcd, <span class="at">ncp =</span><span class="dv">7</span>, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"MCD"</span>)</span>
<span id="cb38-358"><a href="#cb38-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-359"><a href="#cb38-359" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb38-360"><a href="#cb38-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-361"><a href="#cb38-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-364"><a href="#cb38-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-365"><a href="#cb38-365" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_mve, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">7</span>)</span>
<span id="cb38-366"><a href="#cb38-366" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb38-367"><a href="#cb38-367" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb38-368"><a href="#cb38-368" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb38-369"><a href="#cb38-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-370"><a href="#cb38-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-371"><a href="#cb38-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparando la varianza explicada entre PCA no robusto y MVE</span></span>
<span id="cb38-372"><a href="#cb38-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-375"><a href="#cb38-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-376"><a href="#cb38-376" aria-hidden="true" tabindex="-1"></a>pca_out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df_out,</span>
<span id="cb38-377"><a href="#cb38-377" aria-hidden="true" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>)<span class="co"># con datos estandarizados</span></span>
<span id="cb38-378"><a href="#cb38-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-379"><a href="#cb38-379" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(pca_out, </span>
<span id="cb38-380"><a href="#cb38-380" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df_out, </span>
<span id="cb38-381"><a href="#cb38-381" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> F, </span>
<span id="cb38-382"><a href="#cb38-382" aria-hidden="true" tabindex="-1"></a>         <span class="at">label.size =</span> <span class="dv">3</span>, </span>
<span id="cb38-383"><a href="#cb38-383" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="dv">0</span>, <span class="co"># scale=0 biplot segun scores</span></span>
<span id="cb38-384"><a href="#cb38-384" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings.label=</span>T,<span class="co"># nombre de las variables</span></span>
<span id="cb38-385"><a href="#cb38-385" aria-hidden="true" tabindex="-1"></a>         <span class="at">loadings=</span>T)<span class="co"># variables como vectores</span></span>
<span id="cb38-386"><a href="#cb38-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-387"><a href="#cb38-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-388"><a href="#cb38-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-391"><a href="#cb38-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-392"><a href="#cb38-392" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span><span class="fu">fviz_eig</span>(pca_out, </span>
<span id="cb38-393"><a href="#cb38-393" aria-hidden="true" tabindex="-1"></a>              <span class="at">ncp =</span><span class="dv">7</span>, </span>
<span id="cb38-394"><a href="#cb38-394" aria-hidden="true" tabindex="-1"></a>              <span class="at">addlabels =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-395"><a href="#cb38-395" aria-hidden="true" tabindex="-1"></a>              <span class="at">main=</span><span class="st">"No robusto"</span>,</span>
<span id="cb38-396"><a href="#cb38-396" aria-hidden="true" tabindex="-1"></a>              <span class="at">barfill =</span> <span class="st">"#69b3a2"</span>,</span>
<span id="cb38-397"><a href="#cb38-397" aria-hidden="true" tabindex="-1"></a>              <span class="at">barcolor =</span> <span class="st">"#69b3a2"</span>)</span>
<span id="cb38-398"><a href="#cb38-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-399"><a href="#cb38-399" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p2,p3, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb38-400"><a href="#cb38-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-401"><a href="#cb38-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-402"><a href="#cb38-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scree plot del PCA NO robusto</span></span>
<span id="cb38-403"><a href="#cb38-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-406"><a href="#cb38-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-407"><a href="#cb38-407" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_out, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">12</span>)</span>
<span id="cb38-408"><a href="#cb38-408" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb38-409"><a href="#cb38-409" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb38-410"><a href="#cb38-410" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb38-411"><a href="#cb38-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-412"><a href="#cb38-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-413"><a href="#cb38-413" aria-hidden="true" tabindex="-1"></a><span class="fu">## Scree plot del PCA MCD</span></span>
<span id="cb38-414"><a href="#cb38-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-417"><a href="#cb38-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-418"><a href="#cb38-418" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(pca_mcd, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">npcs =</span> <span class="dv">7</span>)</span>
<span id="cb38-419"><a href="#cb38-419" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb38-420"><a href="#cb38-420" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Eigenvalue = 1"</span>),</span>
<span id="cb38-421"><a href="#cb38-421" aria-hidden="true" tabindex="-1"></a><span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>), <span class="at">lty=</span><span class="dv">5</span>, <span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb38-422"><a href="#cb38-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-423"><a href="#cb38-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>